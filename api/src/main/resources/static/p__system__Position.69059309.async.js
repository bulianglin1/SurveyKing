(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[5382],{59686:function(N,P,e){"use strict";e.r(P),e.d(P,{default:function(){return L}});var U=e(57663),x=e(71577),o=e(39428),F=e(3182),b=e(34792),D=e(48086),G=e(71194),E=e(50146),g=e(94657),S=e(3980),T=e(57119),O=e(49101),B=e(87859),R=e(91186),Z=e(80582),h=e(67294),j=e(11849),l=e(82837),n=e(85893),A=(0,Z.Pi)(function(a){var f=a.onOk,p=a.onClose,r=a.position,d=(0,h.useRef)(),c=!!(r!=null&&r.id),y=(0,S.m2)();return(0,n.jsxs)(l.aN,{title:c?r!=null&&r.id?"\u4FEE\u6539\u5C97\u4F4D":"\u65B0\u589E\u5C97\u4F4D":"\u67E5\u770B\u5C97\u4F4D",formRef:d,visible:!0,initialValues:r,drawerProps:{forceRender:!0,destroyOnClose:!0,onClose:function(){p()}},onFinish:function(){var u=(0,F.Z)((0,o.Z)().mark(function t(s){var m;return(0,o.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,y.saveOrUpdatePosition((0,j.Z)((0,j.Z)({},r),s));case 2:m=i.sent,m.success&&f();case 4:case"end":return i.stop()}},t)}));return function(t){return u.apply(this,arguments)}}(),children:[(0,n.jsxs)(l.ZP.Group,{children:[(0,n.jsx)(l.V,{name:"name",width:"md",label:"\u5C97\u4F4D\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u540D\u79F0",required:!0,rules:[{required:!0,message:"\u5C97\u4F4D\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,n.jsx)(l.V,{width:"md",name:"code",label:"\u5C97\u4F4D\u7F16\u7801",placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u7F16\u7801",rules:[{required:!0,message:"\u5C97\u4F4D\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"}],required:!0})]}),(0,n.jsx)(l.ZP.Group,{children:(0,n.jsx)(l._I,{width:"md",request:(0,F.Z)((0,o.Z)().mark(function u(){return(0,o.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",[{label:"\u672C\u4EBA",value:"SELF"},{label:"\u672C\u4EBA\u53CA\u4E0B\u5C5E",value:"SELF_AND_SUB"},{label:"\u672C\u90E8\u95E8",value:"DEPT"},{label:"\u672C\u90E8\u95E8\u53CA\u4E0B\u5C5E\u90E8\u95E8",value:"DEPT_AND_SUB"},{label:"\u5168\u90E8",value:"ALL"}]);case 1:case"end":return s.stop()}},u)})),name:"dataPermissionType",label:"\u6570\u636E\u6743\u9650"})})]})}),I=(0,Z.Pi)(function(){var a=(0,S.m2)(),f=(0,h.useRef)(),p=(0,h.useState)(),r=(0,g.Z)(p,2),d=r[0],c=r[1];(0,h.useEffect)(function(){a.loadPermissions()},[a]);var y=[{title:"\u540D\u79F0",dataIndex:"name",ellipsis:!0},{title:"\u7F16\u7801",dataIndex:"code",hideInSearch:!0},{title:"\u6570\u636E\u6743\u9650",dataIndex:"dataPermissionType",valueEnum:{SELF:"\u672C\u4EBA",SELF_AND_SUB:"\u672C\u4EBA\u53CA\u4E0B\u5C5E",DEPT:"\u672C\u90E8\u95E8",DEPT_AND_SUB:"\u672C\u90E8\u95E8\u53CA\u4E0B\u5C5E\u90E8\u95E8",ALL:"\u5168\u90E8"},hideInSearch:!0},{title:"\u64CD\u4F5C",valueType:"option",width:200,render:function(t,s){return[(0,n.jsx)("a",{onClick:function(){c({visible:!0,current:s})},children:"\u7F16\u8F91"},"edit"),(0,n.jsx)("a",{onClick:function(){E.Z.confirm({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u5C97\u4F4D?",icon:(0,n.jsx)(T.Z,{}),onOk:function(){a.deletePosition(s.id).then(function(i){if(i.success){var C;D.default.success("\u5220\u9664\u6210\u529F"),(C=f.current)===null||C===void 0||C.reload()}})}})},children:"\u5220\u9664"},"delte")]}}];return(0,n.jsxs)(B._z,{title:!1,children:[(0,n.jsx)(R.ZP,{columns:y,actionRef:f,bordered:!0,dataSource:a.positions,request:function(){var u=(0,F.Z)((0,o.Z)().mark(function t(s){return(0,o.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",a.loadPositions(s));case 1:case"end":return v.stop()}},t)}));return function(t){return u.apply(this,arguments)}}(),columnsState:{persistenceKey:"pro-table-singe-position",persistenceType:"localStorage"},rowKey:"id",search:{labelWidth:"auto"},pagination:{pageSize:5},scroll:{x:650},dateFormatter:"string",headerTitle:"\u5C97\u4F4D\u5217\u8868",toolBarRender:function(){return[(0,n.jsx)(x.Z,{icon:(0,n.jsx)(O.Z,{}),type:"primary",onClick:function(){c({visible:!0})},children:"\u65B0\u5EFA"},"button")]}}),(d==null?void 0:d.visible)&&(0,n.jsx)(A,{onClose:function(){c(void 0)},onOk:function(){var t;c(void 0),(t=f.current)===null||t===void 0||t.reload()},position:d.current})]})}),L=I}}]);
