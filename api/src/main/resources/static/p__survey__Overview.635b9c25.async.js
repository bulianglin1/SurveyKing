(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[6420],{96:function(Ot,ae,n){"use strict";n.r(ae),n.d(ae,{Overview:function(){return Ze},default:function(){return Tt}});var se=n(93224),C=n(11849),T=n(94657),a=n(67294),Ne=n(51615),ke=n(69968),ie=n(8935),De=[{key:"answerDailyStat",i:"answerDailyStat",name:"answerDailyStat",title:"\u65E5\u6536\u96C6\u95EE\u5377",layouts:{md:{x:0,y:0,w:12,h:2,i:"answerDailyStat"},lg:{x:0,y:0,w:12,h:2,i:"answerDailyStat"}}},{key:"quickSetting",i:"quickSetting",name:"quickSetting",title:"\u7CFB\u7EDF\u8BBE\u7F6E",layouts:{md:{x:0,y:2,w:6,h:1,i:"quickSetting"},lg:{x:0,y:2,w:6,h:1,i:"quickSetting"}}}],Te=De,Ee=n(91512),Ae=n(68654),Re=n(54549),b=n(11628),p=n(3980),H=n(9761),Fe=n(54941),Oe=n(69610),we=n(27361),Pe=n.n(we),e=n(85893),pe=(0,Fe.Z)(function l(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,Oe.Z)(this,l),this._registry=void 0,this.registerComponent=function(u,c){t._registry[u]=c},this.getComponent=function(u){return Pe()(t._registry,"".concat(u),function(c){return(0,e.jsxs)("div",{children:[u,"\u5BF9\u5E94\u7EC4\u4EF6\u672A\u6CE8\u518C"]})})},this._registry=r}),ze=new pe,G=ze,wt=a.createContext({}),q=n(21063),re=n(18111),Pt=n(71194),le=n(50146),pt=n(49111),oe=n(19650),zt=n(59250),Be=n(13013),Bt=n(57663),M=n(71577),Mt=n(30887),ue=n(28682),Ut=n(34792),U=n(48086),Lt=n(18106),ce=n(60561),_=n(11075),de=n(15873),ee=n(73218),ve=n(64072),Me=n(44545),Ue=n(58491),Le=n(57254),Ye=n(98244),Ve=n(68068),Yt=n(47673),fe=n(4107),We=fe.Z.TextArea;function He(l){var t=(0,a.useState)(),r=(0,T.Z)(t,2),u=r[0],c=r[1];return(0,e.jsxs)(le.Z,{open:!0,title:"\u786E\u8BA4",onOk:function(){return l.onOk(u)},onCancel:l.onCancel,okButtonProps:l.buttonProps,children:[(0,e.jsx)("div",{style:{fontWeight:"bold",marginBottom:10},children:"\u5904\u7406\u53CD\u9988"}),(0,e.jsx)(We,{placeholder:"\u5728\u6B64\u5904\u8F93\u5165\u5904\u7406\u53CD\u9988\uFF0C\u53EF\u4E0D\u586B\u76F4\u63A5\u63D0\u4EA4",value:u,onChange:function(v){return c(v.target.value)}})]})}var Vt=n(87593),he=n(37636),Wt=n(22385),Ke=n(94199),Ht=n(94233),te=n(51890),Qe=n(94184),me=n.n(Qe),be=n(89366),Ge={save:"blue",agree:"green",refuse:"red",reject:"red",revoke:"red",transfer:"red",todo:"orange"},W=function(t){return(0,e.jsx)(Ke.Z,{placement:"bottom",title:(0,e.jsxs)("div",{style:{textAlign:"center",fontSize:12},children:[t.name,(0,e.jsx)("br",{}),t.email]}),children:t.avatar?(0,e.jsx)(te.C,{src:"/api/public/preview/".concat(t.avatar),size:22}):(0,e.jsx)(te.C,{icon:(0,e.jsx)(be.Z,{}),size:22})})},Je=function(t){var r=function(){if(t.approvalType==="save"){var c;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(W,(0,C.Z)({},t.auditUser)),(c=t.auditUser)===null||c===void 0?void 0:c.name," \u53D1\u8D77\u65B0\u7684"]})}else if(t.approvalType==="agree"){var i;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(W,(0,C.Z)({},t.auditUser)),(i=t.auditUser)===null||i===void 0?void 0:i.name," \u5BA1\u6279\u901A\u8FC7"]})}else if(t.approvalType==="todo"){var v,s;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(te.C.Group,{maxCount:3,children:(v=t.waitAuditUserList)===null||v===void 0?void 0:v.filter(function(Z){return!!Z}).map(function(Z){return(0,a.createElement)(W,(0,C.Z)((0,C.Z)({},Z),{},{key:Z.userId}))})}),(s=t.waitAuditUserList)===null||s===void 0?void 0:s.length,"\u6210\u5458\u5904\u7406\u4E2D..."]})}else if(t.approvalType==="refuse"){var h;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(W,(0,C.Z)({},t.auditUser)),(h=t.auditUser)===null||h===void 0?void 0:h.name," \u5BA1\u6279\u62D2\u7EDD"]})}else if(t.approvalType==="rollback"){var x;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(W,(0,C.Z)({},t.auditUser)),(x=t.auditUser)===null||x===void 0?void 0:x.name," \u56DE\u9000\u81F3 ",t.newActivityName]})}else if(t.approvalType==="revert"){var y;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(W,(0,C.Z)({},t.auditUser)),(y=t.auditUser)===null||y===void 0?void 0:y.name," \u64A4\u9500\u5904\u7406"]})}};return(0,e.jsxs)(he.Z.Item,{color:Ge[t.approvalType]||"gray",children:[(0,e.jsx)("div",{className:"audit-time",children:t.createAt}),(0,e.jsxs)("div",{className:"record-item",children:[(0,e.jsx)("div",{className:"item-header",children:t.activityName}),(0,e.jsxs)("div",{className:"item-content",children:[(0,e.jsxs)("div",{className:"content-row",children:[(0,e.jsx)("span",{className:me()("action",t.approvalType),children:r()}),(0,e.jsx)("span",{})]}),t.comment&&(0,e.jsx)("div",{className:"content-row",children:(0,e.jsx)("span",{className:"comment",children:t.comment})})]})]})]},t.id)},$e=function(t){var r=t.processInstanceId,u=(0,a.useState)(),c=(0,T.Z)(u,2),i=c[0],v=c[1];return(0,a.useEffect)(function(){p.hi.getAuditRecord(r).then(function(s){v(s)})},[r]),(0,a.useEffect)(function(){var s=document.getElementsByClassName("ant-tabs-content-holder");s.length>0&&(s[0].scrollTop=s[0].scrollHeight)},[i]),(0,e.jsx)(he.Z,{className:"audit-timeline",children:i==null?void 0:i.map(function(s){return(0,a.createElement)(Je,(0,C.Z)((0,C.Z)({},s),{},{key:s.id||s.activityId}))})})},ge=ce.Z.TabPane,Y="task-edit-modal",Xe=(0,H.Pi)(function(l){var t=l.currentRecord,r=l.currIndex,u=l.total,c=l.onClose,i=l.onNav,v=l.taskType,s=(0,a.useState)(345),h=(0,T.Z)(s,2),x=h[0],y=h[1],Z=(0,a.useRef)(null),R=(0,a.useState)(),z=(0,T.Z)(R,2),F=z[0],O=z[1],k=(0,a.useRef)(null),D=(0,a.useState)([]),j=(0,T.Z)(D,2),I=j[0],E=j[1],d=(0,a.useState)(),m=(0,T.Z)(d,2),o=m[0],f=m[1];(0,a.useEffect)(function(){p.hi.loadFlowSchema({activityId:t.activityId,projectId:t.projectId}).then(function(A){return O(A)})},[t]);var B=(0,a.useState)(!1),X=(0,T.Z)(B,2),P=X[0],S=X[1];(0,a.useEffect)(function(){var A,w=t.answer,g=t.attachment;(A=k.current)===null||A===void 0||A.setValues(w,g)},[t]);var V=function(){return F?(0,e.jsx)(Ve.O,{ref:k,schema:F,headerVisible:!1,footerVisible:!1,paginationVisible:!1,initialValues:t.answer,fieldPermission:t.fieldPermission}):(0,e.jsx)(e.Fragment,{})},Ie=function(w){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;i(w==="up"?r-1:r+1,g)},Et=function(){return(0,e.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",overflow:"hidden"},children:(0,e.jsxs)(ce.Z,{defaultActiveKey:"1",children:[(0,e.jsx)(ge,{tab:"\u65E5\u5FD7",children:(0,e.jsx)($e,{processInstanceId:t.processInstanceId})},"1"),(0,e.jsx)(ge,{tab:"\u7559\u8A00",children:"Content of Tab Pane 2"},"2")]})})},At=function(){return(0,e.jsx)(ue.Z,{onClick:function(g){var N,Q=g.key;(N=k.current)===null||N===void 0||N.submit().then(function(L){L?f({visible:!0,buttonProps:{type:"ghost",icon:(0,e.jsx)(_.Z,{})},callback:function(Ft){S(!0),p.hi.approvalTask({answer:L.values,attachment:L.attachments,answerId:t.answerId,taskId:t.id,type:"rollback",activityId:t.activityId,comment:Ft,projectId:t.projectId,processInstanceId:t.processInstanceId,newActivityId:Q}).then(function(){U.default.success("\u5DF2\u56DE\u9000"),S(!1),f(void 0),i(r,!0)})}}):S(!1)})},children:I==null?void 0:I.map(function(w,g){return(0,e.jsx)(ue.Z.Item,{children:(0,e.jsx)("a",{children:g!==I.length-1?w.activityName:"\u53D1\u8D77\u4EBA"})},w.activityId)})})},Rt=function(){return(0,e.jsxs)(oe.Z,{children:[v===1&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(M.Z,{type:"primary",loading:P,icon:(0,e.jsx)(de.Z,{}),onClick:function(){var g;(g=k.current)===null||g===void 0||g.submit().then(function(N){N?f({visible:!0,buttonProps:{type:"primary",icon:(0,e.jsx)(de.Z,{})},callback:function(L){S(!0),p.hi.approvalTask({answer:N.values,attachment:N.attachments,answerId:t.answerId,taskId:t.id,type:"agree",activityId:t.activityId,comment:L,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){U.default.success("\u5BA1\u6838\u901A\u8FC7"),S(!1),f(void 0),i(r,!0)})}}):S(!1)})},children:"\u901A\u8FC7"}),(0,e.jsx)(M.Z,{type:"primary",danger:!0,icon:(0,e.jsx)(ee.Z,{}),loading:P,onClick:function(){var g;(g=k.current)===null||g===void 0||g.submit().then(function(N){N?f({visible:!0,buttonProps:{type:"primary",danger:!0,icon:(0,e.jsx)(ee.Z,{})},callback:function(L){S(!0),p.hi.approvalTask({answer:N.values,attachment:N.attachments,answerId:t.answerId,taskId:t.id,type:"refuse",activityId:t.activityId,comment:L,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){U.default.success("\u5DF2\u62D2\u7EDD"),S(!1),f(void 0),i(r,!0)})}}):S(!1)})},children:"\u62D2\u7EDD"}),(0,e.jsx)(Be.Z,{overlay:At,placement:"topCenter",trigger:["click"],children:(0,e.jsx)(M.Z,{onClick:function(){p.hi.getRevertNodes(t.processInstanceId).then(function(g){g&&E(g)})},icon:(0,e.jsx)(_.Z,{}),loading:P,children:"\u56DE\u9000"})})]}),v===2&&t.status===1&&t.latest&&t.approvalType!=="revert"&&(0,e.jsx)(M.Z,{onClick:function(){var g;(g=k.current)===null||g===void 0||g.submit().then(function(N){N?f({visible:!0,buttonProps:{type:"primary",danger:!0,icon:(0,e.jsx)(ee.Z,{})},callback:function(L){S(!0),p.hi.approvalTask({answer:N.values,attachment:N.attachments,answerId:t.answerId,taskId:t.id,type:"revert",activityId:t.activityId,newActivityId:t.activityId,comment:L,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){U.default.success("\u5DF2\u64A4\u56DE"),S(!1),f(void 0),i(r,!0)})}}):S(!1)})},icon:(0,e.jsx)(_.Z,{}),loading:P,children:"\u64A4\u56DE"}),v===4&&t.status===6&&(0,e.jsx)(M.Z,{onClick:function(){var g;(g=k.current)===null||g===void 0||g.submit().then(function(N){N?f({visible:!0,buttonProps:{type:"primary",icon:(0,e.jsx)(ve.Z,{})},callback:function(L){S(!0),p.hi.approvalTask({answer:N.values,attachment:N.attachments,answerId:t.answerId,taskId:t.id,type:"save",activityId:t.activityId,comment:L,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){U.default.success("\u5DF2\u64A4\u56DE"),S(!1),f(void 0),i(r,!0)})}}):S(!1)})},icon:(0,e.jsx)(ve.Z,{}),loading:P,children:"\u518D\u6B21\u63D0\u4EA4"}),(0,e.jsx)(M.Z,{onClick:function(){},icon:(0,e.jsx)(Me.Z,{}),loading:P})]})};return(0,e.jsx)("div",{ref:Z,className:"edit-data ",children:(0,e.jsxs)(le.Z,{open:!0,maskClosable:!1,title:!1,width:900,onCancel:function(){return c()},className:"task-edit-modal",footer:!1,children:[(0,e.jsxs)("div",{style:{display:"flex"},children:[(0,e.jsxs)("div",{className:Y+"-survey-container",style:{flex:1},children:[(0,e.jsx)("div",{className:Y+"-survey-container-title",children:"\u6211\u7684\u5BA1\u6279"}),(0,e.jsx)("div",{className:Y+"-survey-container-content",children:V()}),(0,e.jsxs)("div",{className:Y+"-survey-container-footer",children:[(0,e.jsxs)("div",{className:"nav",children:[(0,e.jsxs)("span",{children:[r+1,"/",u]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(M.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(Ue.Z,{}),disabled:r===0,onClick:function(){return Ie("up")}}),(0,e.jsx)(M.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(Le.Z,{}),disabled:r===u-1,onClick:function(){return Ie("down")}})]})]}),Rt()]})]}),(0,e.jsxs)("div",{className:Y+"-metaInfo-container",style:{width:x},children:[(0,e.jsx)("div",{className:Y+"-metaInfo-container-title"}),(0,e.jsx)("div",{className:Y+"-metaInfo-container-content",children:Et()}),(0,e.jsx)("div",{className:Y+"-metaInfo-container-resizer",style:{transform:x===0?"rotateY(180deg) translate3d(100%,-50%,0)":"translate3d(0,-50%,0)"},onClick:function(){y(x===0?350:0)},children:(0,e.jsx)(Ye.Z,{})})]})]}),(o==null?void 0:o.visible)&&(0,e.jsx)(He,{onOk:function(w){return o.callback(w)},onCancel:function(){return f(void 0)},buttonProps:o.buttonProps})]})})}),qe=(0,H.Pi)(function(l){var t=l.projectId,r=l.taskType,u=(0,a.useContext)(ne),c=(0,p.iZ)(t),i=(0,p.Ge)(t),v=(0,a.useRef)(),s=i.tasks[r]||{list:[],total:0,current:1,pageSize:50},h=(0,a.useState)(),x=(0,T.Z)(h,2),y=x[0],Z=x[1],R=(0,a.useState)(),z=(0,T.Z)(R,2),F=z[0],O=z[1];(0,a.useEffect)(function(){var d=s.list.length;if(y===void 0){O(void 0);return}if(d===0){Z(void 0);return}if(y>=d){Z(0);return}y!==void 0&&s.current&&s.total&&O({currIndex:y,total:s.total,currentRecord:s.list[y]})},[y,s]);var k=function(m,o){i.loadFlowTasks({type:r,projectId:t,current:m,pageSize:o})};(0,a.useEffect)(function(){(r||y===void 0)&&k()},[r,y]);var D=c.schema,j=(0,a.useMemo)(function(){var d=(0,re.ZZ)(D)||[];return d.splice(0,0,{name:"approvalStage",title:"\u5F53\u524D\u6D41\u7A0B\u72B6\u6001",width:180}),d.push({name:"createUser",title:"\u7533\u8BF7\u4EBA"}),d.push({name:"createAt",title:"\u7533\u8BF7\u65F6\u95F4",width:180}),d.push({name:"updateAt",title:"\u66F4\u65B0\u65F6\u95F4",width:180}),d},[D]),I=(0,a.useMemo)(function(){var d=(0,re.IR)(s.list,j);return d.forEach(function(m){var o;m.createUser=(o=m.createUser)===null||o===void 0?void 0:o.name}),d},[s,j]),E=function(m,o){F&&(o?i.removeTask(F.currentRecord.id,r):Z(m))};return(0,e.jsxs)("div",{children:[(0,e.jsx)(q._$,{ref:v,width:u.width-10,height:u.height-95,data:I,schema:j,selectionMode:"row",allowSorting:!0,onDoubleClick:function(m){var o;if(((o=m.data)===null||o===void 0?void 0:o._i)!==void 0){var f;Z((f=m.data)===null||f===void 0?void 0:f._i)}}}),(0,e.jsxs)("div",{className:"statusBar-container",children:[(0,e.jsx)("div",{children:(0,e.jsx)("div",{style:{fontSize:12,color:"##767e89",userSelect:"none"},children:"\u53CC\u51FB\u884C\u5BA1\u6279"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)(q.tl,{current:s.current,pageSize:s.pageSize,total:s.total,onChange:function(m){k(m.current,m.pageSize)}}),(0,e.jsx)(q.hY,{onClick:function(){return k(s.current,s.pageSize)}})]}),(0,e.jsx)("div",{})]}),F&&(0,e.jsx)(Xe,(0,C.Z)((0,C.Z)({},F),{},{taskType:r,onClose:function(){Z(void 0)},onNav:E}))]})}),_e=(0,H.Pi)(function(l){var t=(0,a.useContext)(b.xI),r=(t==null?void 0:t.id)||l.projectId,u=(0,p.iZ)(r),c=Zt();return(0,a.useEffect)(function(){u.loadProject()},[u,r]),(0,e.jsx)("div",{style:{padding:"2px 5px"},className:"task-widget",children:(0,e.jsx)(qe,{projectId:r,taskType:parseInt(c.activeKey||"0")})})});G.registerComponent("taskCenter",_e);var Kt=n(13062),ye=n(71230),Qt=n(77576),xe=n(12028),bt=n(89032),J=n(15746),Gt=n(20136),et=n(55241),$=n(39428),je=n(3182),tt=n(23538),Se=n(92592),nt=fe.Z.Search;function at(l){return"".concat(window.location.origin,"/s/").concat(l)}var st=function(){var t,r,u,c,i=(0,b.IE)(),v=i.loading,s=(t=i.project)===null||t===void 0||(r=t.setting)===null||r===void 0?void 0:r.status,h=(0,a.useState)(s===1),x=(0,T.Z)(h,2),y=x[0],Z=x[1],R=(u=i.project)===null||u===void 0||(c=u.setting)===null||c===void 0?void 0:c.answerSetting.autoSave,z=(0,a.useState)(R),F=(0,T.Z)(z,2),O=F[0],k=F[1];(0,a.useEffect)(function(){Z(s===1)},[s]),(0,a.useEffect)(function(){k(R)},[R]);var D=at(i.id),j=(0,a.useState)(""),I=(0,T.Z)(j,2),E=I[0],d=I[1];(0,a.useEffect)(function(){function o(){return f.apply(this,arguments)}function f(){return f=(0,je.Z)((0,$.Z)().mark(function B(){return(0,$.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:Se.toDataURL(D,{errorCorrectionLevel:"H",type:"image/jpeg",quality:.3,margin:1}).then(function(S){d(S)}).catch(function(S){console.error(S)});case 1:case"end":return P.stop()}},B)})),f.apply(this,arguments)}o()},[D]);var m=(0,a.useCallback)(function(){var o=(0,je.Z)((0,$.Z)().mark(function f(B){return(0,$.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:Se.toDataURL(D,{errorCorrectionLevel:"H",margin:1,width:B}).then(function(S){d(S);var V=document.createElement("a");V.href=S,V.setAttribute("download","".concat(i.name,"_").concat(B,".png")),document.body.appendChild(V),V.click(),document.body.removeChild(V)});case 1:case"end":return P.stop()}},f)}));return function(f){return o.apply(this,arguments)}}(),[D,i]);return(0,e.jsx)(ye.Z,{gutter:[20,20],style:{padding:10},children:(0,e.jsx)(J.Z,{sm:24,xs:24,children:(0,e.jsxs)(ye.Z,{gutter:[10,10],children:[(0,e.jsxs)(J.Z,{span:24,className:"setting-item",children:[(0,e.jsx)(nt,{value:D,style:{width:360},enterButton:"\u6253\u5F00",className:"open-target",onSearch:function(){window.open("/s/".concat(i.id))}}),(0,e.jsx)(et.Z,{content:(0,e.jsxs)("div",{children:[(0,e.jsx)("img",{src:E,height:150,width:150}),(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsxs)(oe.Z,{children:[(0,e.jsx)(M.Z,{size:"small",type:"link",onClick:function(){return m(256)},children:"\u5C0F\u53F7"}),(0,e.jsx)(M.Z,{size:"small",type:"link",onClick:function(){return m(512)},children:"\u4E2D\u53F7"}),(0,e.jsx)(M.Z,{size:"small",type:"link",onClick:function(){return m(1024)},children:"\u5927\u53F7"})]})})]}),title:"".concat(i.name,"(\u4E8C\u7EF4\u7801)"),trigger:["click"],children:(0,e.jsx)(tt.Z,{style:{fontSize:30}})})]}),(0,e.jsxs)(J.Z,{className:"setting-item",span:24,children:[(0,e.jsx)("div",{className:"title",children:"\u95EE\u5377\u5F00\u542F/\u505C\u6B62"}),(0,e.jsx)("div",{children:(0,e.jsx)(xe.Z,{checked:y,onChange:function(f){Z(f),p.hi.updateSetting({id:i.id,settingKey:"status",settingValue:f?1:0}).then(function(B){B.code===200?f?U.default.info("\u95EE\u5377\u5DF2\u5F00\u542F"):U.default.warn("\u95EE\u5377\u5DF2\u505C\u6B62"):U.default.error(B.message)})}})})]}),(0,e.jsxs)(J.Z,{className:"setting-item",span:24,children:[(0,e.jsx)("div",{className:"title",children:"\u95EE\u5377\u586B\u5199\u65F6\u81EA\u52A8\u4FDD\u5B58"}),(0,e.jsx)("div",{children:(0,e.jsx)(xe.Z,{checked:O,onChange:function(f){k(f),p.hi.updateSetting({id:i.id,settingKey:"answerSetting.autoSave",settingValue:f}).then(function(B){B.code===200?f?U.default.info("\u6682\u5B58\u5DF2\u5F00\u542F"):U.default.warn("\u6682\u5B58\u5DF2\u505C\u6B62"):U.default.error(B.message)})}})})]})]})})})};G.registerComponent("quickSetting",(0,H.Pi)(st));var it=n(68023),rt=n(81615),lt=n(8690),ot=n(17813),ut=n(73761),ct=n(73865),dt=n(60532),vt=n(37744),ft=n(5931),ht=n(79813),mt=n(70012),gt=n(27484),K=n.n(gt),yt=n(37181),xt=n.n(yt);K().extend(xt()),it.D([lt.N,ot.N,ut.N,ct.N,ft.N,mt.N,ht.z,dt.N,vt.N]);var Ce=function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=K()(),u=K().min(Object.keys(t).map(function(h){return K()(h,"YYYY-MM-DD")}).concat(r.add(-6,"day"))),c=[],i=[],v=u;!K()().add(1,"day").isSame(v,"day");v=v.add(1,"day")){var s=v.format("YYYY-MM-DD");c.push(s),i.push(t[s]||0)}return{dateList:c,data:i}},jt=function(t){var r=(0,b.IE)(),u=r.reportData,c=(0,a.useRef)(),i=(0,a.useRef)(null);return(0,a.useEffect)(function(){if(i.current){var v=rt.S1(i.current);c.current=v;var s,h=Ce();s={visualMap:[{show:!1,type:"continuous",seriesIndex:0,min:0,max:400}],tooltip:{trigger:"axis"},xAxis:[{data:h.dateList}],dataZoom:[{type:"inside",startValue:"2022-05-03",endValue:"2022-05-08"},{start:0,end:20}],yAxis:[{}],series:[{type:"line",showSymbol:!1,smooth:!0,symbol:"none",areaStyle:{},data:h.data}]},s&&v.setOption(s),v.resize({height:t.height-30})}},[]),(0,a.useEffect)(function(){r.loadReportData()},[]),(0,a.useEffect)(function(){if(u&&c.current&&u.dailyCountStat){var v=Ce(u.dailyCountStat),s=v.dateList,h=v.data;c.current.setOption({xAxis:[{data:s}],series:[{data:h}]})}},[u]),(0,a.useEffect)(function(){c.current&&c.current.resize({height:t.height-30,width:t.width})},[t.width,t.height]),(0,e.jsx)("div",{ref:i,children:"AnswerDailyStat"})};G.registerComponent("answerDailyStat",(0,H.Pi)(jt));var St=function(t){var r=t.tabs,u=t.defaultActive,c=(0,a.useState)(u||r[0].key),i=(0,T.Z)(c,2),v=i[0],s=i[1],h=function(y){s(y),t.onChange(y)};return(0,e.jsx)("div",{className:"tabs-nav-list",children:r.map(function(x){return(0,e.jsx)("div",{onClick:function(){return h(x.key)},className:me()("tabs-tab",{active:v===x.key}),children:x.title},x.key)})})},Ct=["style","className","key","children","name","title","tabs","widgetProps","toggleFullScreen"],ne=a.createContext({});function Zt(){return(0,a.useContext)(ne)}var It=a.forwardRef(function(l,t){var r=l.style,u=l.className,c=l.key,i=l.children,v=l.name,s=l.title,h=l.tabs,x=l.widgetProps,y=l.toggleFullScreen,Z=(0,se.Z)(l,Ct),R=(0,a.useState)(h&&h[0].key),z=(0,T.Z)(R,2),F=z[0],O=z[1],k=(0,a.useState)(!1),D=(0,T.Z)(k,2),j=D[0],I=D[1],E=function(){return h?(0,e.jsx)(St,{tabs:h,onChange:function(o){return O(o)}}):(0,e.jsx)("span",{className:"",children:s})};return(0,e.jsxs)("div",(0,C.Z)((0,C.Z)({style:(0,C.Z)({},r),className:["widget",u].join(" ")},Z),{},{ref:t,children:[(0,e.jsxs)("div",{className:"header",children:[(0,e.jsxs)("span",{className:"title",children:[E(),(0,e.jsx)("div",{className:"drag-handle"})]}),(0,e.jsxs)("div",{className:"widget-controls",children:[j&&(0,e.jsx)(Ee.Z,{className:"control-item",onClick:function(){I(!1),y()}}),!j&&(0,e.jsx)(Ae.Z,{className:"control-item",onClick:function(){I(!0),y()}}),(0,e.jsx)(Re.Z,{className:"control-item"})]})]}),(0,e.jsx)(ie.SizeMe,{monitorHeight:!0,children:function(m){var o=m.size;return(0,e.jsx)(ne.Provider,{value:{height:o.height||0,width:o.width||0,activeKey:F},children:(0,e.jsx)("div",{style:{height:"100%"},children:a.createElement(G.getComponent(v),(0,C.Z)((0,C.Z)({},x),{},{height:o.height,width:o.width}))})})}}),i]}),c)}),Nt=It,kt=n(2026),Dt=["key"],Ze=function(t){var r=(0,Ne.UO)(),u=r.id,c=(0,b.IE)(),i=c.id,v=(0,a.useState)(function(){return Te}),s=(0,T.Z)(v,2),h=s[0],x=s[1],y=(0,a.useState)(function(){var D=localStorage.getItem("layout-".concat(i));return D!=null?JSON.parse(D):h.reduce(function(j,I){return j.lg.push(I.layouts.lg),j.md.push(I.layouts.md),j},{lg:[],md:[]})}),Z=(0,T.Z)(y,2),R=Z[0],z=Z[1],F=(0,a.useRef)(0),O=(0,a.useRef)();if(u==="new")return(0,e.jsx)(kt.default,(0,C.Z)({},t));var k=function(j){if(O.current)z(O.current.cacheLayouts),x(O.current.cacheData),O.current=void 0;else if(R){O.current={key:j,cacheData:h,cacheLayouts:R};var I=Object.keys(R).reduce(function(E,d){var m=R[d].filter(function(o){return o.i===j})[0];return E[d]=[(0,C.Z)((0,C.Z)({},m),{},{x:0,y:0,h:(F.current-100)/150,i:j,statusbar:!0})],E},{});z(I),x(h.filter(function(E){return E.key===j}))}};return(0,e.jsx)("div",{className:"survey-overview",children:(0,e.jsx)(ie.SizeMe,{monitorHeight:!0,children:function(j){var I=j.size;return F.current=I.height||0,(0,e.jsx)(ke.Responsive,{autoSize:!1,className:"layout",onDrag:function(d){},draggableHandle:".drag-handle",breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:12,sm:12,xs:4,xxs:2},width:I.width||0,layouts:R,useCSSTransforms:!1,onLayoutChange:function(d,m){O.current||localStorage.setItem("layout-".concat(i),JSON.stringify(m))},children:h.map(function(E){var d=E.key,m=(0,se.Z)(E,Dt);return(0,e.jsx)(Nt,(0,C.Z)((0,C.Z)({},m),{},{toggleFullScreen:function(){return k(d)}}),d)})})}})})},Tt=Ze}}]);
