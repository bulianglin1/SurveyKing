(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[1495],{92801:function(){},76898:function(je,ae,x){"use strict";x.d(ae,{Ff:function(){return He},rF:function(){return B},M2:function(){return ee}});var L=x(22385),W=x(94199),A=x(11849),U=x(93224),Z=x(54707),P=x(49914),E=x(9761),re=x(94184),e=x.n(re),le=x(94657),se=x(78338),ie=x(67294),F=x(85893);function $e(T){if(T=Number(T),T<=0)return"0:0:0";var V=Math.floor(T/3600),H=Math.floor(T%3600/60),J=Math.floor(T%3600%60),Q="".concat(V).padStart(2,"0"),Y="".concat(H).padStart(2,"0"),ne="".concat(J).padStart(2,"0");return"".concat(Q,":").concat(Y,":").concat(ne)}function ce(T){return T<=60?"#ff4d4f":T<=180?"#faad14":"#52c41a"}var Ne=(0,E.Pi)(function(){var T,V,H=(0,P.H)(),J=(0,Z.Rk)(),Q=H.startTime,Y=((T=H.project)===null||T===void 0||(V=T.setting.examSetting)===null||V===void 0?void 0:V.maxSubmitMinutes)||0,ne=(0,ie.useState)(0),ve=(0,le.Z)(ne,2),de=ve[0],oe=ve[1],xe=Q+Y*60*1e3,ue=(0,ie.useRef)();return(0,ie.useEffect)(function(){if(Y!==0)return ue.current=window.setInterval(function(){oe((xe-new Date().getTime())/1e3)},1e3),function(){clearInterval(ue.current)}},[xe]),(0,ie.useEffect)(function(){de<0&&(J.submit(),clearInterval(ue.current))},[de]),Y===0?(0,F.jsx)(F.Fragment,{}):(0,F.jsxs)("div",{style:{position:"absolute",right:0,fontSize:13},children:[(0,F.jsx)(se.Z,{style:{marginRight:5,color:"#1890ff"}}),"\u5269\u4F59:",(0,F.jsx)("span",{style:{marginLeft:3,color:ce(de)},children:$e(de)})]})}),Oe=["size","marked"],ee=(0,E.Pi)(function(T){var V=(0,Z.Rk)(),H=V.props.answerSheetVisible,J=T.size,Q=T.marked,Y=Q===void 0?!0:Q,ne=(0,U.Z)(T,Oe);return H?(0,F.jsx)(W.Z,{title:"\u6807\u8BB0",children:(0,F.jsx)("svg",(0,A.Z)((0,A.Z)({viewBox:"0 0 1024 1024",version:"1.1",width:T.size||24,height:T.size||24,className:"marked"},ne),{},{children:(0,F.jsx)("path",{d:"M662.04973405 329.56834123l108.40905238-142.19888693c4.22372932-5.63163908 4.22372932-11.26327817 1.40790978-18.30282702-2.81581955-5.63163908-8.44745863-9.8553684-15.48700748-9.85536841H218.55815604c-9.8553684 0-16.89491725 7.03954885-16.89491725 16.89491726V867.38987389c0 9.8553684 7.03954885 16.89491725 16.89491725 16.89491726s16.89491725-7.03954885 16.89491726-16.89491726V487.25423562h522.33452519c7.03954885 0 12.67118794-4.22372932 15.48700749-9.8553684s1.40790977-12.67118794-2.81581955-18.30282703l-108.40905238-129.52769896z",fill:Y?"#EA4942":"#d8d8d8","p-id":"1287"})}))}):(0,F.jsx)(F.Fragment,{})}),B=(0,E.Pi)(function(T){var V,H,J,Q=T.id,Y=T.name,ne=(0,Z.Rk)(),ve=ne.answerSheet,de=ve.find(function(Ce){return Ce.id===Q}),oe=(0,P.H)(),xe=oe==null||(V=oe.project)===null||V===void 0?void 0:V.isAuthenticated,ue=(H=oe.project)===null||H===void 0||(J=H.setting.examSetting)===null||J===void 0?void 0:J.randomSurveyWrong,Me=ne.exerciseMode;return(!Me||!xe||Q.length<=10)&&!ue?(0,F.jsx)(F.Fragment,{}):de!=null&&de.favorite?(0,F.jsx)(W.Z,{title:ue?"\u79FB\u51FA\u9519\u9898":"\u79FB\u51FA\u6536\u85CF",children:(0,F.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",width:"24",height:"24",style:{float:"right"},onClick:function(){ne.favoriteQuestion({templateId:Q,name:Y},!1)},children:(0,F.jsx)("path",{d:"M484.266667 272.021333l6.634666 6.72c5.973333 5.973333 13.013333 12.842667 21.098667 20.629334l9.194667-8.917334c7.253333-7.04 13.44-13.184 18.56-18.432a193.28 193.28 0 0 1 277.44 0c75.904 77.525333 76.629333 202.794667 2.133333 281.194667L512 853.333333 204.672 553.237333c-74.474667-78.421333-73.770667-203.690667 2.133333-281.216a193.28 193.28 0 0 1 277.44 0z","p-id":"2829",fill:"#d81e06"})})}):(0,F.jsx)(W.Z,{title:ue?"\u6DFB\u52A0\u5230\u9519\u9898":"\u6536\u85CF",children:(0,F.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",width:24,height:24,style:{float:"right"},onClick:function(){ne.favoriteQuestion({templateId:Q,name:Y})},children:(0,F.jsx)("path",{d:"M484.267 272.021l6.634 6.72c5.974 5.974 13.014 12.843 21.099 20.63l9.195-8.918c7.253-7.04 13.44-13.184 18.56-18.432a193.28 193.28 0 0 1 277.44 0c75.904 77.526 76.629 202.795 2.133 281.195L512 853.333 204.672 553.237c-74.475-78.421-73.77-203.69 2.133-281.216a193.28 193.28 0 0 1 277.44 0z m293.162 232.15c46.272-53.76 44.182-136.15-5.973-187.371a129.28 129.28 0 0 0-185.984 0l-15.125 15.104a1687.253 1687.253 0 0 1-4.395 4.31L512 388.18l-49.28-47.445-13.227-12.928-10.965-11.008a129.28 129.28 0 0 0-186.005 0c-51.456 52.565-52.31 137.963-2.198 191.573L512 763.883l261.675-255.531 3.754-4.181z","p-id":"2674",fill:"#d8d8d8"})})})}),ke=(0,E.Pi)(function(T){var V=(0,Z.Rk)(),H=T.finished,J=T.id,Q=T.marked,Y=T.seqNo;return(0,F.jsxs)("div",{className:e()("answer-sheet-item",{marked:Q,finished:H}),onClick:function(){return V.changePageIndex(J)},children:[Y,Q&&(0,F.jsx)(ee,{style:{position:"absolute",left:20,bottom:18},size:18})]})}),Ee=(0,E.Pi)(function(){var T=(0,Z.Rk)(),V=T.answerSheet;return(0,F.jsx)(F.Fragment,{children:V.filter(function(H){return H.display!=="none"}).map(function(H,J){return(0,ie.createElement)(ke,(0,A.Z)((0,A.Z)({},H),{},{seqNo:J+1,key:H.id}))})})}),Le=(0,E.Pi)(function(){var T=(0,Z.Rk)(),V=T.answerSheet,H=V.filter(function(Y){return Y.finished}).length,J=V.filter(function(Y){return!Y.finished}).length,Q=V.filter(function(Y){return Y.marked}).length;return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)("div",{className:"finished",children:["\u5DF2\u7B54",(0,F.jsx)("span",{style:{marginLeft:4},children:H})]}),(0,F.jsxs)("div",{className:"unFinished",children:["\u672A\u7B54",(0,F.jsx)("span",{style:{marginLeft:4},children:J})]}),(0,F.jsxs)("div",{className:"marked",children:[(0,F.jsx)(ee,{size:18}),"\u6807\u8BB0",(0,F.jsx)("span",{style:{marginLeft:4},children:Q})]})]})}),Ae=(0,E.Pi)(function(){return(0,F.jsxs)("div",{className:"answer-sheet-header",children:["\u7B54\u9898\u5361",(0,F.jsx)(Ne,{})]})}),He=(0,E.Pi)(function(){var T=(0,Z.Rk)(),V=T.props.answerSheetVisible;return V?(0,F.jsxs)("div",{className:"answer-sheet",children:[(0,F.jsx)(Ae,{}),(0,F.jsx)("div",{className:"answer-sheet-content",children:(0,F.jsx)(Ee,{})}),(0,F.jsx)("div",{className:"answer-sheet-footer",children:(0,F.jsx)(Le,{})})]}):(0,F.jsx)(F.Fragment,{})})},94905:function(je,ae,x){"use strict";x.r(ae),x.d(ae,{default:function(){return Rt}});var L=x(94657),W=x(40807),A=x(78210),U=x(9761),Z=x(67294),P=x(54707),E=x(48187),re=x(73057),e=x(85893),le=function(){var n=(0,P.AK)(),l=(0,Z.useContext)(W.ZX),d=l.schema;return(0,e.jsxs)("div",{className:n+"-header",children:[(0,e.jsx)("div",{className:n+"-header-title",children:(0,e.jsx)(re.hl,{html:d.title})}),(0,e.jsx)("div",{className:n+"-header-description",children:(0,e.jsx)(re.hl,{html:d.description})})]})},se=function(n){var l=(0,P.AK)();return(0,e.jsx)("div",{className:l+"-body",children:n.children})},ie=x(77576),F=x(12028),$e=x(57663),ce=x(71577),Ne=(0,U.Pi)(function(){var t,n,l=(0,P.AK)("-footer"),d=(0,Z.useContext)(W.ZX),a=d.schema,g=d.loading,h=(0,P.Rk)(),c=h.pagination,o=c.current,v=c.pageSize,i=v>1,r=o===1,u=o===v;return(0,e.jsxs)("div",{className:l,children:[u&&(0,e.jsx)("div",{className:l+"-desc",style:{userSelect:"none"},children:(0,e.jsx)(re.hl,{html:a==null||(t=a.attribute)===null||t===void 0?void 0:t.suffix})}),(0,e.jsxs)("div",{className:l+"-pagination",children:[i&&!r&&(0,e.jsx)("div",{children:(0,e.jsx)(ce.Z,{type:"primary",block:!0,onClick:function(){return h.handlePrev()},children:"\u4E0A\u4E00\u9875"})}),i&&!u&&(0,e.jsx)("div",{children:(0,e.jsx)(ce.Z,{type:"primary",block:!0,onClick:function(){return h.handleNext()},children:"\u4E0B\u4E00\u9875"})}),u&&(0,e.jsx)("div",{children:(0,e.jsx)(ce.Z,{type:"primary",block:!0,onClick:function(){return h.submit()},loading:g,children:(0,e.jsx)(re.hl,{html:((n=a.attribute)===null||n===void 0?void 0:n.submitButton)||"\u63D0\u4EA4"})})}),i&&(0,e.jsxs)("div",{className:l+"-pagination-info",children:["\u7B2C",o,"\u9875/\u5171",v,"\u9875"]}),h.autoNextPage>0&&(0,e.jsxs)("div",{style:{color:"#999",display:"flex",alignItems:"center",justifyContent:"center",width:200},children:["\u7B54\u5BF9\u81EA\u52A8\u8DF3\u8F6C\u4E0B\u4E00\u9875",(0,e.jsx)(F.Z,{style:{marginLeft:5},checked:h.autoNextPage===1,onChange:function(m){m?h.autoNextPage=1:h.autoNextPage=2}})]})]})]})}),Oe=x(47673),ee=x(4107),B=x(11849),ke=x(77883),Ee=x(85986),Le=x(14965),Ae=x(68318),He=x(39002),T=x(68351),V=x(43358),H=x(66074),J=x(29985),Q=x(46842),Y=x(64302),ne=x(27484),ve=x.n(ne),de=x(33852);ve().locale("zh-cn");function oe(t,n){if(!!t)return ve()(t,n)}var xe=function(n){var l=n.dictCode,d=n.value,a=n.onChange,g=n.style,h=n.bordered,c=n.className,o=n.parentValue,v=n.cascaderLevel,i=v===void 0?1:v,r=(0,P.Al)(),u=(0,Z.useState)([]),s=(0,L.Z)(u,2),m=s[0],f=s[1],C=(0,P.zE)(function(j){i&&i>1&&!o||r.onDictSearch&&r.onDictSearch({dictCode:l,searchValue:j,parentValue:o==null?void 0:o.split("|")[0],cascaderLevel:i}).then(function(y){f(y||[])})},2);return(0,Z.useEffect)(function(){i&&i>1&&(o?C(void 0):f([]))},[o,i]),(0,Z.useEffect)(function(){!d&&i<=1&&l&&C(void 0),d&&m.length===0&&C(d)},[d]),(0,e.jsx)(H.Z,{options:m,showSearch:!0,onSearch:C,value:d==null?void 0:d.split("|")[0],onChange:function(y){var p;return a("".concat(y,"|").concat((p=m.find(function(b){return b.value===y}))===null||p===void 0?void 0:p.label))},style:g,bordered:h,dropdownClassName:c,allowClear:!0})};function ue(t,n){return n||(t==="date"?"YYYY-MM-DD":t==="dateTime"?"YYYY-MM-DD HH:mm:ss":t==="time"?"HH:mm:ss":"YYYY-MM-DD")}function Me(t){return t?t==="YYYY"?"year":t==="YYYY-MM"?"month":"date":"date"}var Ce=function(n){var l=n.onChange,d=n.type,a=n.value,g=n.style,h=g===void 0?{width:"100%"}:g,c=n.className,o=n.readOnly,v=n.bordered,i=ue(d,n.dateTimeFormat);return i.startsWith("HH")?(0,e.jsx)(T.Z,{value:oe(a,i),format:i,onChange:function(u,s){return l(s)},style:h,className:c,disabled:o,bordered:v}):(0,e.jsx)(Ae.Z,{onChange:function(u,s){l(s)},disabled:o,format:i,picker:Me(i),showTime:i.includes("HH")||i.includes("mm")||i.includes("ss"),showSecond:i.includes("ss"),showMinute:i.includes("mm"),showHour:i.includes("HH"),value:oe(a,i),style:h,className:c,bordered:v})},he=function(n){var l,d=n.onChange,a=n.type,g=n.value,h=n.suffix,c=n.style,o=c===void 0?{width:"100%"}:c,v=n.className,i=n.dictCode,r=n.onBlur,u=r===void 0?function(){}:r,s=n.bordered,m=n.parentValue,f=n.cascaderLevel,C=n.icon,j=C===void 0?!0:C,y=n.readOnly,p=y===void 0?!1:y,b=n.schema,N=n.placeholder,w=N===void 0?b==null||(l=b.attribute)===null||l===void 0?void 0:l.placeholder:N;return a==="horzBlank"?(0,e.jsx)(e.Fragment,{}):a==="selectDict"&&i?(0,e.jsx)(xe,{value:g,onChange:d,dictCode:i,style:o,bordered:s,className:v,parentValue:m,cascaderLevel:f}):a==="select"&&b!==null&&b!==void 0&&b.dataSource?(0,e.jsx)(H.Z,{options:b.dataSource,style:{width:200},bordered:s,onChange:d,placeholder:w}):a==="number"?(0,e.jsx)(Ee.Z,{className:v,onChange:d,onBlur:function(S){var I=S.target.value;u(I===""?void 0:parseFloat(I))},value:g,style:o,addonAfter:h,readOnly:p,bordered:s,placeholder:w}):a==="date"||a==="dateTime"||a==="time"?(0,e.jsx)(Ce,(0,B.Z)({},n)):a==="mobile"?(0,e.jsx)(ee.Z,{prefix:j?(0,e.jsx)(J.Z,{}):void 0,onChange:function(S){return d(S.target.value)},value:g,className:v,onBlur:function(S){return u(S.target.value)},bordered:s,readOnly:p,placeholder:w}):a==="idCard"?(0,e.jsx)(ee.Z,{prefix:j?(0,e.jsx)(Q.Z,{}):void 0,onChange:function(S){return d(S.target.value)},value:g,style:o,className:v,onBlur:function(S){return u(S.target.value)},bordered:s,readOnly:p,placeholder:w}):a==="email"?(0,e.jsx)(ee.Z,{prefix:j?(0,e.jsx)(Y.Z,{}):void 0,onChange:function(S){return d(S.target.value)},onBlur:function(S){return u(S.target.value)},value:g,style:o,className:v,bordered:s,readOnly:p,placeholder:w}):a==="password"?(0,e.jsx)(ee.Z.Password,{onChange:function(S){return d(S.target.value)},onBlur:function(S){return u(S.target.value)},value:g,suffix:h,style:o,className:v,bordered:s,readOnly:p,placeholder:w||"\u8BF7\u8F93\u5165\u5BC6\u7801"}):(0,e.jsx)(ee.Z,{onChange:function(S){return d(S.target.value)},onBlur:function(S){return u(S.target.value)},value:g,suffix:h,style:o,className:v,bordered:s,readOnly:p,placeholder:w})},Tt=x(49111),Pe=x(19650),rn=x(17672),ln=function(n){var l=n.onChange,d=(0,Z.useRef)(null),a=(0,Z.useRef)(),g=(0,Z.useRef)(),h=(0,Z.useState)(0),c=(0,L.Z)(h,2),o=c[0],v=c[1];return(0,Z.useEffect)(function(){var i=d.current;if(i){var r,u=new rn.Z(d.current);u.addEventListener("beginStroke",function(){v(1)}),a.current=u;var s=Math.max(window.devicePixelRatio||1,1);i.width=i.offsetWidth*s,i.height=i.offsetHeight*s,(r=i.getContext("2d"))===null||r===void 0||r.scale(s,s)}},[]),(0,e.jsxs)("div",{className:"signature-pad",children:[(0,e.jsx)("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#aaa",visibility:g.current?"hidden":"visible"},children:"\u70B9\u51FB\u7B7E\u540D"}),(0,e.jsxs)("div",{className:"signature",children:[(0,e.jsx)("canvas",{ref:d,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none",display:o!==2?"block":"none"}}),o===2&&(0,e.jsx)("img",{src:g.current||void 0})]}),(0,e.jsxs)("div",{className:"save-signature",children:[(0,e.jsx)("span",{children:"\u7B7E\u540D\u5B8C\u6210\u540E\uFF0C\u8BF7\u70B9\u51FB\u3010\u5B8C\u6210\u3011\u6309\u94AE"}),(0,e.jsx)("div",{children:(0,e.jsxs)(Pe.Z,{children:[o===1&&(0,e.jsx)(ce.Z,{type:"link",onClick:function(){var r;(r=a.current)===null||r===void 0||r.clear(),v(0)},children:"\u6E05\u7A7A"}),(o===0||o===1)&&(0,e.jsx)(ce.Z,{type:"primary",disabled:o!==1,ghost:!0,size:"small",onClick:function(){var r;l(a.current.toDataURL()),g.current=(r=a.current)===null||r===void 0?void 0:r.toDataURL(),v(2)},children:"\u5B8C\u6210"}),o===2&&(0,e.jsx)(ce.Z,{type:"primary",ghost:!0,size:"small",onClick:function(){var r;v(0),(r=a.current)===null||r===void 0||r.clear()},children:"\u91CD\u7B7E"})]})})]})]})},sn=x(3024),dn=(0,U.Pi)(function(){var t=(0,Z.useContext)(W.ZX),n=t.progressBar,l=(0,P.AK)(),d=(0,P.Rk)(),a=d.progress;return n?(0,e.jsx)(sn.Z,{enabled:!0,top:0,innerActiveClass:"fixed",children:(0,e.jsx)("div",{className:l+"-progress",children:(0,e.jsx)("div",{className:"progress-bar s-prog-wait",children:(0,e.jsx)("div",{className:"progress-done  s-prog-done",style:{width:"".concat(a*100,"%")}})})})}):(0,e.jsx)(e.Fragment,{})}),ze=function(n){var l,d=n.optionId,a=n.questionId,g=n.checked,h=n.checkedCount,c=n.quota,o=n.statEnabled,v=(0,P.Al)(),i=v.statistics,r=i==null?void 0:i.questionStatistics[a],u=((r==null?void 0:r.optionStatistics.reduce(function(C,j){return C+j.count},0))||0)+h,s=(r==null||(l=r.optionStatistics.find(function(C){return C.optionId===d}))===null||l===void 0?void 0:l.count)||0,m=g?s+1:s,f="".concat(Math.floor(m/u*1e3)/10,"%");return!o&&c===void 0?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)("span",{className:"vote-info",children:[c&&(0,e.jsxs)("span",{className:"vote-info-cnt",style:{color:c-s>0?"#1890ff":"#949aae"},children:["(\u4F59",c-s,")"]}),o&&h>0&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("span",{className:"vote-info-cnt",children:[m,"\u7968"]}),(0,e.jsx)("span",{className:"vote-info-percent ",children:f}),(0,e.jsx)("div",{className:"vote-info-bar",children:(0,e.jsx)("div",{className:"vote-info-bar-fill",style:{width:f}})})]})]})},Fe=function(n){var l=n.schema,d=n.type,a=l.attribute,g=a===void 0?{}:a,h=g.examCorrectAnswer,c=(0,P.Al)(),o=c.correctAnswerVisible,v=c.mode;return h&&o&&v==="exam"?d==="FillBlank"||d==="HorzBlank"||d==="MultipleBlank"?(0,e.jsx)("span",{className:"correct-answer",children:h}):(0,e.jsx)("span",{className:"correct-answer",children:"\uFF08\u6B63\u786E\u7B54\u6848\uFF09"}):(0,e.jsx)(e.Fragment,{})},Dt=function(n){var l=n.schema,d=l.attribute,a=d===void 0?{}:d,g=a.examScore,h=useSurvey(),c=h.mode,o=h.examScoreVisible;return g&&c==="exam"&&o?_jsxs("span",{className:"question-score",children:["\uFF08",g,"\u5206\uFF09"]}):_jsx(_Fragment,{})},on=(0,U.Pi)(function(t){var n=(0,P.Rk)(),l=n.reviewAnswer[t.qId];return l&&!l.visible?(0,e.jsx)("span",{className:"review-answer-btn",onClick:function(){l.visible=!0},children:"\u67E5\u770B\u7B54\u6848"}):(0,e.jsx)(e.Fragment,{})}),$t=x(63185),pe=x(9676),un=x(36862),cn=x(46533),vn=x(94184),ge=x.n(vn),hn=x(91220),Ue=x(15020);function We(t,n,l,d){if(!t)return"";var a=RegExp("_{3,}","g"),g=t.matchAll(a),h=[],c=(0,hn.Z)(g),o;try{for(c.s();!(o=c.n()).done;){var v=o.value,i=v.index,r=v.index+v[0].length;h.push([i,r])}}catch(f){c.e(f)}finally{c.f()}if(h.length===0)return t;for(var u=h[0][0]===0?"":t.substring(0,h[0][0]),s=function(C){var j,y,p=h[C],b=h[C+1],N=t.substring(p[0],p[1]),w=t.substring(p[1],b?b[0]:t.length),M=n[C],S=l?l[M.id]:"";if(((j=M.attribute)===null||j===void 0?void 0:j.dataType)==="select"){var I,D;S=(I=M.dataSource)===null||I===void 0||(D=I.find(function(k){return k.value===S}))===null||D===void 0?void 0:D.label}else if(((y=M.attribute)===null||y===void 0?void 0:y.dataType)==="selectDict"){var R,$;S=(R=S)===null||R===void 0||($=R.split("|"))===null||$===void 0?void 0:$[1]}u+='<input data-id="'.concat(n[C].id,`" value='`).concat(S||"",`'  class="horz-blank" style="width:`).concat(12*N.length,'px">'),u+=w},m=0;m<h.length;m++)s(m);return u}var Ze=(0,U.Pi)(function(t){var n=t.content,l=t.children,d=t.value,a=d===void 0?{}:d,g=t.onChange,h=t.onBlur,c=t.schema,o=(0,P.Rk)(),v=o.reviewAnswer[c.id];function i(r,u){var s,m;if(a[r]!==u){a[r]=u;var f=l.find(function(p){return p.id===r}),C=f==null||(s=f.attribute)===null||s===void 0?void 0:s.cascaderLevel,j=f==null||(m=f.attribute)===null||m===void 0?void 0:m.dictCode;j&&C&&l.filter(function(p){var b;return((b=p.attribute)===null||b===void 0?void 0:b.dictCode)===j&&p.attribute.cascaderLevel&&p.attribute.cascaderLevel>C}).forEach(function(p){delete a[p.id]}),(u===""||u===void 0)&&delete a[r];var y=(0,B.Z)({},a);if(Object.keys(y).length!==0)return y}}return(0,e.jsx)("div",{className:"pe-view",onClick:function(u){u.preventDefault(),u.stopPropagation()},children:(0,Ue.ZP)(We(n,l),{replace:function(u){var s=u.attribs;if(!!s){var m=s["data-id"];if(m){var f,C,j,y,p,b=(0,Ue.e_)(s),N=l.findIndex(function(K){return K.id===m}),w=l[N],M=(f=l[N-1])===null||f===void 0?void 0:f.id,S=a[M],I=(w==null||(C=w.attribute)===null||C===void 0?void 0:C.dataType)||"text",D=w==null||(j=w.attribute)===null||j===void 0?void 0:j.dictCode,R=w==null||(y=w.attribute)===null||y===void 0?void 0:y.dateTimeFormat,$=(p=w.attribute)===null||p===void 0?void 0:p.cascaderLevel,k=v==null?void 0:v[m].isCorrect,O=ge()(b.className,{selected:v&&v.visible,"is-correct":v&&v.visible&&k});return(0,e.jsx)(he,(0,B.Z)((0,B.Z)({type:I,value:a[m],parentValue:S,schema:w,cascaderLevel:$,onChange:function(z){return g(i(m,z))},onBlur:function(z){return h(i(m,z))},dictCode:D,dateTimeFormat:R,bordered:!1,icon:!1},b),{},{className:O}))}}}})})}),fn=(0,U.Pi)(function(t){var n=t.qId,l=t.schema,d=t.checked,a=t.onChange,g=t.value,h=t.onBlur,c=t.disabled,o=l.id,v=l.title,i=l.attribute,r=i===void 0?{}:i,u=(0,P.Rk)(),s=u.reviewAnswer[n],m=s==null?void 0:s[o].selected,f=s==null?void 0:s[o].isCorrect,C=r.dataType;return s&&s.visible&&(m||f)?(0,e.jsxs)("label",{className:ge()("ant-checkbox-wrapper ant-checkbox-wrapper-in-form-item",{selected:m,"is-correct":f}),onClick:function(){return a(!d)},children:[(0,e.jsxs)("span",{children:[!f&&(0,e.jsx)(un.Z,{size:17,style:{color:"#ff6d56",marginRight:10,fontSize:17}}),f&&(0,e.jsx)(cn.Z,{size:17,style:{color:"#00bf6f",marginRight:10,fontSize:17}})]}),(0,e.jsx)("div",{className:"option-label-wrap",children:(0,e.jsx)(A.Z,{html:v})})]}):(0,e.jsxs)(pe.Z,{value:o,checked:d,onChange:function(y){return a(y.target.checked)},disabled:c,children:[C==="horzBlank"&&l.children?(0,e.jsx)(Ze,{content:v,children:l.children,value:g,schema:l,onBlur:h,onChange:function(y){return a(!0,y)}}):(0,e.jsx)(A.Z,{html:v}),(0,e.jsx)(Fe,{schema:t.schema})]})}),Ot=x(88983),be=x(66253),Ve=x(43061),Ke=x(38819),mn=x(91508),xn=(0,U.Pi)(function(t){var n=t.qId,l=t.schema,d=t.onBlur,a=t.onChange,g=t.value,h=t.disabled,c=l.id,o=l.title,v=l.attribute,i=(0,P.Rk)(),r=i.reviewAnswer[n],u=r==null?void 0:r[c].selected,s=r==null?void 0:r[c].isCorrect,m=Z.useContext(mn.ZP),f=v==null?void 0:v.dataType;return r&&r.visible&&(u||s)?(0,e.jsxs)("label",{className:ge()("ant-radio-wrapper ant-radio-wrapper-in-form-item radio-item",{selected:u,"is-correct":s}),onClick:function(){var j;h||m==null||(j=m.onChange)===null||j===void 0||j.call(m,{target:{value:c}})},children:[(0,e.jsxs)("span",{children:[!s&&(0,e.jsx)(Ve.Z,{style:{color:"#ff6d56",marginRight:10}}),s&&(0,e.jsx)(Ke.Z,{style:{color:"#00bf6f",marginRight:10}})]}),(0,e.jsx)("div",{className:"option-label-wrap",children:(0,e.jsx)(A.Z,{html:o})})]}):(0,e.jsxs)(be.ZP,{value:c,className:"radio-item",disabled:h,children:[f==="horzBlank"&&l.children?(0,e.jsx)(Ze,{schema:l,content:o,children:l.children,value:typeof g=="boolean"?{}:g,onBlur:d,onChange:a}):(0,e.jsx)(A.Z,{html:o}),(0,e.jsx)(Fe,{schema:t.schema})]})}),gn=(0,U.Pi)(function(t){var n=t.schema,l=t.value,d=t.onChange,a=t.qId,g=t.onBlur,h=(0,P.AK)("-body-question"),c=n.id,o=n.attribute,v=o==null?void 0:o.suffix,i=o==null?void 0:o.dataType,r=o==null?void 0:o.dictCode,u=o==null?void 0:o.dateTimeFormat,s=o==null?void 0:o.readOnly,m=(0,P.Rk)(),f=m.reviewAnswer[a],C=f==null?void 0:f[c].isCorrect;return f&&f.visible?(0,e.jsxs)("span",{style:{position:"relative"},children:[!C&&(0,e.jsx)(Ve.Z,{style:{color:"#ff6d56",marginRight:10,position:"absolute",left:0,top:3,zIndex:1}}),C&&(0,e.jsx)(Ke.Z,{style:{color:"#00bf6f",marginRight:10,position:"absolute",left:0,top:3,zIndex:1}}),(0,e.jsx)(he,{type:i,value:l[c],readOnly:s,schema:n,className:ge()("selected",{"is-correct":C}),onChange:function(y){return d(y)},onBlur:g,style:{paddingLeft:20},suffix:v&&(0,e.jsx)("span",{className:h+"-option-suffix",children:(0,e.jsx)(A.Z,{html:v})})})]}):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(he,{type:i,value:l[c],onChange:function(y){return d(y)},onBlur:g,schema:n,readOnly:s,dictCode:r,dateTimeFormat:u,suffix:v&&(0,e.jsx)("span",{className:h+"-option-suffix",children:(0,e.jsx)(A.Z,{html:v})})})})}),kt=x(65011),Lt=x(48736),Ht=x(402),jn=x(20294),Cn=H.Z.Option,we=jn.Z.Text,zt=function(n){var l=n.onChange,d=n.form,a=n.record,g=useState(n.value),h=_slicedToArray(g,2),c=h[0],o=h[1],v=useState(n.value),i=_slicedToArray(v,2),r=i[0],u=i[1];useEffect(function(){u(n.value)},[n.value]);var s=useState([{id:"1",drugName:"\u6D4B\u8BD5\u7528\u836F",chemicalName:"hahah11",stCompName:"\u4E0A\u6D77\u5236\u836F\u5382"},{id:"2",drugName:"\u6D4B\u8BD5\u7528\u836F1",chemicalName:"hahah11",stCompName:"\u5E7F\u4E1C\u5236\u836F\u5382"}]),m=_slicedToArray(s,2),f=m[0],C=m[1],j=useThrottleCallback(function(y){},4);return _jsx(_AutoComplete,{showSearch:!0,placeholder:"\u70B9\u51FB\u641C\u7D22",value:r,dropdownMatchSelectWidth:!1,onBlur:function(){u(c),c?l==null||l(c):l==null||l(void 0)},onSelect:function(p){o(p),u(p)},allowClear:!0,onClear:function(){o(void 0),u(void 0),l==null||l(void 0)},onSearch:function(p){u(p),j(p)},dropdownRender:function(p){return _jsxs(_Fragment,{children:[p,_jsx(_Divider,{style:{margin:"8px 0"}}),_jsxs(_Space,{align:"center",style:{padding:"0 8px 4px"},children:[_jsx(we,{children:"\u836F\u7269\u540D\u79F0"}),_jsx(we,{type:"secondary",style:{fontSize:12},children:"(\u5546\u54C1\u540D-\u5382\u5BB6)"})]})]})},children:f.map(function(y){return _jsxs(Cn,{value:y.drugName,children:[_jsxs(we,{children:[" ",y.drugName]}),_jsxs(we,{type:"secondary",style:{fontSize:12,marginLeft:5},children:["(",y.chemicalName,"-",y.stCompName,")"]})]},y.id)})})},yn=(0,U.Pi)(function(t){var n,l=t.schema,d=t.title,a=t.onBlur,g=t.onChange,h=l.type,c=((n=l.children)===null||n===void 0?void 0:n.filter(function(i){var r;return(r=i.attribute)===null||r===void 0?void 0:r.fieldInTitle}))||[],o=(0,U.U$)(),v=o.value;return h!=="HorzBlank"||c.length===0?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(A.Z,{html:d})}):(0,e.jsx)(Ze,{schema:l,children:c,content:d,onChange:g,onBlur:a,value:v})}),pn=(0,e.jsx)("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24",children:(0,e.jsx)("path",{d:"M839 73.9c-1.2-2.4-3.7-9.8-7.4-9.8s-11.1 8.6-13.5 12.3l-13.5 12.3c-7.4-6.1-35.6-23.4-43-23.4-11.1 0-104.6 113.2-118.1 129.1l-60.2 68.8-30.7 38.1-43.1-83.6-50.4-100.8c-4.9-9.8-8.6-22.1-22.1-22.1-7.3 0-9.8 3.6-13.5 9.8-3.7 4.9-3.7 4.9-11.1 8.6-8.6 0-12.3 0-19.7 6.2-6.2-4.9-11.1-11.1-19.7-11.1-3.7 0-6.2 1.2-8.6 3.6l-8.6 7.4c-4.8 6.1-15.9 17.2-15.9 25.8 0 11 9.8 31.9 13.5 41.8l90.9 250.8-14.7 17.3c-66.4 79.8-159.8 190.5-210.2 279l-29.5 50.4c-8.6 14.7-29.5 44.3-29.5 60.2 0 3.7 3.8 6.2 6.2 8.6 8.6 7.3 3.6 14.7 1.2 24.5-2.5 7.4-3.7 12.3-3.7 19.7 0 13.5 11.1 27 18.5 38.1 7.3 12.2 9.9 24.5 25.8 24.5 17.2 0 49.2-3.6 63.9-14.7l243.4-377.5 115.6 178.5c6.1 9.8 30.7 54.1 46.7 54.1 14.8 0 38.1-16.1 40.6-30.8-2.6-4.9-6.2-12.3-6.2-17.2 0-7.5 19.7-14.9 24.6-19.7v-9.9c8.6-3.7 13.5-8.6 17.2-17.2l-95.9-205.3-38.2-76.3 13.6-19.7 174.6-225.9c11-14.8 28.3-38.1 41.8-50.4 4.9-5 13.5-12.3 13.5-19.7 0-8.6-19.7-22.1-24.6-34.4z","p-id":"14396",fill:"#fe6c56"})}),Zn=(0,e.jsx)("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24",children:(0,e.jsx)("path",{d:"M389.7 604.3L198.2 447.4c-3.7-3-9.1-3-12.8 0.1l-73.3 61.4c-4.4 3.7-4.8 10.3-0.9 14.5l324.1 344.3c5 5.3 13.8 3.6 16.6-3.1 64.4-160.1 244.3-452.8 463.2-664.7 3-2.9 3.9-7.2 2.3-11l-13.7-33c-2.4-5.8-9.5-8-14.7-4.5-243.2 157.7-419.4 353.5-499.3 452.9z",fill:"#fe6c56","p-id":"4913"})}),bn=(0,U.Pi)(function(t){var n,l=t.schema,d=t.seqNo,a=(0,P.Rk)(),g=a.props.correctAnswerVisible,h=a.props.questionScore,c=(n=l.attribute)===null||n===void 0?void 0:n.examAnswerMode;return!g||!h||c==="none"?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)("div",{className:"exam-score-info",children:[(0,e.jsxs)("span",{children:["\u7B2C",d,"\u9898"]}),h[l.id]?(0,e.jsxs)("div",{style:{display:"flex"},children:[(0,e.jsxs)("span",{className:"score",children:["\u5F97\u5206:",h[l.id],"\u5206"]}),Zn]}):pn]})}),Ut=x(71194),wn=x(50146);function Ye(t){return t?t.substring(0,t.lastIndexOf("[")):"\u70B9\u51FB\u9009\u62E9"}var Bn=function(n){var l=n.onChange,d=n.value,a=n.mapMove,g=a===void 0?!1:a,h=n.optionId,c=(0,Z.useRef)(null),o=(0,Z.useRef)(),v=(0,Z.useRef)(),i=(0,Z.useRef)(),r=(0,Z.useState)(function(){if(!!d){var S=d.match(/\[(\d+\.\d+),\s*(\d+\.\d+)\]/);if(S&&S.length>2)return[parseFloat(S[1]),parseFloat(S[2])]}}),u=(0,L.Z)(r,2),s=u[0],m=u[1],f=(0,Z.useState)(function(){return Ye(d)}),C=(0,L.Z)(f,2),j=C[0],y=C[1],p=(0,Z.useState)(!1),b=(0,L.Z)(p,2),N=b[0],w=b[1],M=(0,Z.useCallback)(function(S){v.current.getLocation(S,function(I,D){if(I==="complete"&&D.geocodes.length){var R=D.geocodes[0].location;i.current.start(R)}else console.error("\u6839\u636E\u5730\u5740\u67E5\u8BE2\u4F4D\u7F6E\u5931\u8D25")})},[]);return(0,Z.useEffect)(function(){if(!!N){window["localMap".concat(h)]=function(){initAMapUI(),AMapUI.loadUI(["misc/PositionPicker"],function($){var k=new AMap.Map("map-".concat(h),{zoom:16,center:s,dragEnable:g,zoomEnable:g});if(o.current=k,g){var O=new $({mode:"dragMarker",map:k});O.on("success",function(G){y(G.address),m([G.position.lng,G.position.lat])}),s?O.start(s):O.start(),k.panBy(0,1),i.current=O}var K=new AMap.Geocoder({city:"010"});v.current=K;var z=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,offset:[10,20],zoomToAccuracy:!0,position:"RB"});z.getCurrentPosition(function(G,q){G=="complete"?(k.setCenter(q.position),y(q.formattedAddress),m([q.position.lng,q.position.lat])):console.error(q)})})},window._AMapSecurityConfig={securityJsCode:"c92dc7c089f25dcd7944094d3ee1a959"};var S="https://webapi.amap.com/maps?v=1.4.15&key=fce3217057b3ace0b2128cb5d1696c87&callback=localMap".concat(h,"&plugin=AMap.Geocoder,AMap.Geolocation"),I=document.createElement("script");I.src=S,document.head.appendChild(I);var D="https://webapi.amap.com/ui/1.1/main-async.js",R=document.createElement("script");R.src=D,document.head.appendChild(R)}},[N]),(0,e.jsxs)("div",{style:{position:"relative"},children:[(0,e.jsx)(ee.Z.TextArea,{readOnly:!0,value:Ye(d),onClick:function(){return w(!0)}}),(0,e.jsxs)(wn.Z,{open:N,onCancel:function(){w(!1)},onOk:function(){s&&l("".concat(j,"[").concat(s[0],", ").concat(s[1],"]")),w(!1)},children:[(0,e.jsx)("div",{style:{display:"flex",justifyContent:"space-between",width:200},children:g&&(0,e.jsx)(ee.Z.Search,{placeholder:"\u8BF7\u8F93\u5165\u8981\u641C\u7D22\u7684\u5730\u70B9\u3001\u8857\u9053",size:"small",onSearch:function(I){return M(I)}})}),(0,e.jsx)("div",{ref:c,id:"map-".concat(h),style:{height:390}}),(0,e.jsx)("div",{style:{height:50,borderTop:"1px solid #b0b0b0",background:"#fff",padding:"12px 18px"},children:j})]})]})},Sn=(0,U.Pi)(function(t){var n,l,d=t.qId,a=t.schema,g=(0,P.Rk)(),h=g.reviewAnswer[d],c=(n=a.children)===null||n===void 0?void 0:n.map(function(r){var u;return(u=r.attribute)===null||u===void 0?void 0:u.examCorrectAnswer}).filter(function(r){return r}).join(";"),o=c&&["FillBlank","MultipleBlank","Textarea","HorzBlank"].includes(a.type),v=function(){return o?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"answer-analysis-title",children:"\u6B63\u786E\u7B54\u6848\uFF1A"}),(0,e.jsx)("div",{className:"answer-analysis-content",style:{marginBottom:10},children:c})]}):(0,e.jsx)(e.Fragment,{})},i=function(){var u;if((u=a.attribute)!==null&&u!==void 0&&u.examAnalysis){var s;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"answer-analysis-title",children:"\u7B54\u6848\u89E3\u6790\uFF1A"}),(0,e.jsx)("div",{className:"answer-analysis-content",children:(0,e.jsx)(A.Z,{html:(s=a.attribute)===null||s===void 0?void 0:s.examAnalysis})})]})}return(0,e.jsx)(e.Fragment,{})};return h&&h.visible&&((l=a.attribute)!==null&&l!==void 0&&l.examAnalysis||o)?(0,e.jsxs)("div",{className:"answer-analysis",children:[v(),i()]}):(0,e.jsx)(e.Fragment,{})}),Ie=x(76898);function Nn(t){var n=t.schema,l=t.index,d=t.required,a=t.error,g=t.replaceTitle,h=t.seqNo,c=t.onBlur,o=t.onChange,v=t.onFocus,i=(0,Z.useContext)(W.ZX),r=i.questionNumber,u=i.requiredVisible,s=(0,P.AK)("-body-question"),m=(0,Z.useState)(),f=(0,L.Z)(m,2),C=f[0],j=f[1],y=n.description,p=(0,P.Rk)(),b=p.answerSheet.find(function(M){return M.id===n.id}),N=b==null?void 0:b.marked;(0,Z.useEffect)(function(){if(C){var M,S;(M=document.querySelector("[data-id='".concat(n.id,"']")))===null||M===void 0||M.classList.remove("ant-form-item-has-error"),(S=document.querySelector("[data-id='".concat(n.id,"']")))===null||S===void 0||S.querySelectorAll("[data-id]").forEach(function(K){K.classList.remove("ant-form-item-has-error")})}if(a.length>0){var I,D=a[0].split("^"),R=(0,L.Z)(D,2),$=R[0],k=R[1],O;k?(O=document.querySelector("[data-id='".concat($,"']")),j(k)):(O=document.querySelector("[data-id='".concat(n.id,"']")),j($)),(I=O)===null||I===void 0||I.classList.add("ant-form-item-has-error")}else C&&j(void 0)},[a]);var w=function(){return C?(0,e.jsx)("span",{className:"question-tag error animated",children:(0,e.jsx)("span",{children:C})}):(0,e.jsx)(e.Fragment,{})};return(0,e.jsxs)("section",{className:s,children:[(0,e.jsx)("div",{className:"".concat(s,"-head"),children:(0,e.jsxs)("span",{className:s+"-header",children:[(0,e.jsx)(bn,{schema:n,seqNo:l+1}),(0,e.jsxs)("h2",{className:s+"-header-title",children:[r&&(0,e.jsx)("span",{className:s+"-header-title-seq",children:(0,e.jsx)("b",{children:r?h:""})}),d&&u&&(0,e.jsx)("span",{className:s+"-header-title-required",children:(0,e.jsx)("i",{children:"*"})}),(0,e.jsx)("div",{className:s+"-header-title-text",children:(0,e.jsx)(yn,{schema:n,title:g||n.title,onBlur:c,onChange:o,onFocus:v})}),w(),(0,e.jsx)(Ie.M2,{marked:N,onClick:function(){p.markQuestion(n.id,!N)}}),(0,e.jsx)(Ie.rF,{id:n.id,name:n.title})]}),y&&(0,e.jsx)("div",{className:"question-desc",children:(0,e.jsx)(A.Z,{html:y})})]})}),(0,e.jsxs)("div",{className:"".concat(s,"-body"),children:[t.children,(0,e.jsx)(on,{qId:n.id}),(0,e.jsx)(Sn,{qId:n.id,schema:n})]})]})}(0,E.eC)("Question",(0,U.Pi)(Nn),"antd");function En(t){var n=t.schema,l=t.index,d=t.seqNo,a=(0,P.AK)("-body-questionSet"),g=(0,Z.useContext)(W.ZX),h=g.questionNumber;return(0,e.jsxs)("div",{className:a,children:[(0,e.jsxs)("div",{className:a+"-title",children:[h&&(0,e.jsx)("span",{className:a+"-title-seq",children:(0,e.jsx)("b",{children:h?d:""})}),(0,e.jsx)(A.Z,{html:n.title})]}),t.children,(0,e.jsx)("div",{className:a+"-splitLine"})]})}(0,E.eC)("QuestionSet",En,"antd");var Wt=x(84305),An=x(88182),Mn=x(82925);ve().locale("zh-cn");function Pn(t){var n=t.headerVisible,l=t.footerVisible,d=t.schema,a=(0,P.AK)(),g=(0,P.Al)(),h=function(){var o,v=(o=d.attribute)===null||o===void 0?void 0:o.headerImage;if(v)return(0,e.jsx)("img",{src:"/api/public/preview/".concat(v),style:{maxWidth:"100%"}})};return(0,e.jsxs)("div",{className:ge()(a,{preview:g.isPreview}),children:[(0,e.jsx)(dn,{}),(0,e.jsx)("div",{className:a+"-banner",children:h()}),n&&(0,e.jsx)(le,{}),(0,e.jsx)(An.ZP,{locale:Mn.Z,children:(0,e.jsx)(se,{children:t.children})}),l&&(0,e.jsx)(Ne,{}),(0,e.jsx)(Ie.Ff,{})]})}(0,E.eC)("Survey",Pn,"antd");var Vt=x(13062),te=x(71230),Kt=x(89032),_=x(15746),X=x(32059);function Fn(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children;function h(c,o){l((0,X.Z)({},o,c))}return(0,e.jsx)("div",{children:g==null?void 0:g.map(function(c){var o=c.id,v=c.title,i=c.attribute,r=i===void 0?{}:i,u=r.mapMove;return(0,e.jsxs)(te.Z,{gutter:[10,0],"data-id":o,children:[v&&(0,e.jsx)(_.Z,{span:24},c.id),(0,e.jsx)(_.Z,{span:24,children:(0,e.jsx)(Bn,{optionId:o,onChange:function(m){return h(m,o)},value:a[o],mapMove:u})})]},o)})})}(0,E.RM)("Address",Fn,"antd");var Yt=x(43185),Be=x(32620),Gt=x(34792),Ge=x(48086),Se=x(39428),Qe=x(3182),In=x(81473);function Rn(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=t.readOnly,h=n.children,c=h===void 0?[]:h,o=(0,P.Al)(),v=function(){var i=(0,Qe.Z)((0,Se.Z)().mark(function r(u){var s,m,f,C;return(0,Se.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:s=u.onSuccess,m=u.onError,f=u.file,C=u.onProgress,o.onUpload&&o.onUpload({file:f,fileType:6},function(p){C&&C({percent:p.loaded/p.total*100})}).then(function(p){if(p.success&&s&&(s(p.data),p.data.content&&l((0,X.Z)({},c[0].id,p.data.content))),!p.success&&m){var b=new Error("Some error");m({event:b})}});case 2:case"end":return y.stop()}},r)}));return function(u){return i.apply(this,arguments)}}();return(0,e.jsx)("div",{children:c==null?void 0:c.map(function(i){var r=i.id,u=i.attribute,s=u===void 0?{}:u,m=s.cameraOnly;return(0,e.jsx)(te.Z,{style:{marginBottom:10},"data-id":r,children:(0,e.jsx)(_.Z,{span:12,children:(0,e.jsx)(ee.Z,{placeholder:"\u70B9\u51FB\u8BC6\u522B\u6761\u7801",value:a[r],addonAfter:(0,e.jsx)(Be.Z,{accept:"image/*",capture:m?"environment":void 0,disabled:g,maxCount:1,beforeUpload:function(C){return s!=null&&s.maxFileSize&&C.size>s.maxFileSize*1024*1024?(Ge.default.error("\u6700\u5927\u53EA\u80FD\u4E0A\u4F20 ".concat(s.maxFileSize,"M \u5927\u5C0F\u7684\u6587\u4EF6")),Be.Z.LIST_IGNORE):!0},customRequest:v,showUploadList:!1,children:(0,e.jsx)(In.Z,{})},r)})})},r)})})}(0,E.RM)("Barcode",Rn,"antd");var Qt=x(36877),Tn=x(95897);function Dn(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children,h=g===void 0?[]:g;function c(o){var v={};o.forEach(function(i,r){var u=h[r].id;v[u]=i}),l(v)}return(0,e.jsx)(te.Z,{children:(0,e.jsx)(_.Z,{span:12,children:(0,e.jsx)(Tn.Z,{value:h.map(function(o){return a[o.id]}).filter(function(o){return o}),style:{width:260},options:n.dataSource,onChange:c,placeholder:"\u8BF7\u9009\u62E9"})})})}(0,E.RM)("Cascader",Dn,"antd");function $n(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=t.onBlur,h=n.children,c=n.attribute,o=24/((c==null?void 0:c.columns)||1),v=(0,P.AK)("-body-question"),i=!!(c!=null&&c.statEnabled),r=(0,P.Al)(),u=(0,P.Rk)(),s=u.hiddenOption[n.id]||[];(0,Z.useEffect)(function(){var f=Object.keys(a),C=!1;f.forEach(function(j){s.includes(j)&&(C=!0,delete a[j])}),C&&l((0,B.Z)({},a))},[s]);function m(f,C,j){return C?a[f]=j||!0:delete a[f],(0,B.Z)({},a)}return(0,Z.useEffect)(function(){h==null||h.forEach(function(f){var C;(C=f.attribute)!==null&&C!==void 0&&C.defaultChecked&&Object.keys(a).length===0&&l((0,X.Z)({},f.id,!0))})},[]),(0,e.jsx)("div",{children:(0,e.jsx)(te.Z,{children:h==null?void 0:h.filter(function(f){return!s.includes(f.id)}).map(function(f){var C,j,y,p,b=f.id,N=(C=f.attribute)===null||C===void 0?void 0:C.dataType,w=(j=f.attribute)===null||j===void 0?void 0:j.suffix,M=(y=f.attribute)===null||y===void 0?void 0:y.readOnly,S=(p=f.attribute)===null||p===void 0?void 0:p.quota,I=!1;if(S!==void 0){var D,R=r.statistics,$=R==null?void 0:R.questionStatistics[n.id],k=($==null||(D=$.optionStatistics.find(function(K){return K.optionId===b}))===null||D===void 0?void 0:D.count)||0,O=S-k;O<=0&&(I=!0)}return(0,e.jsxs)(_.Z,{span:o,className:v+"-option","data-id":b,children:[(0,e.jsx)(fn,{disabled:I,qId:n.id,schema:f,checked:a.hasOwnProperty(b),onChange:function(z,G){I||l(m(b,z,G))},value:typeof a[b]=="boolean"?{}:a[b],onBlur:g}),(0,e.jsx)(ze,{statEnabled:i,quota:S,checked:!!a[b],optionId:b,questionId:n.id,checkedCount:Object.keys(a).length}),N&&(0,e.jsx)(he,{value:typeof a[b]=="boolean"?"":a[b],style:{maxWidth:200},type:N,onChange:function(z){return l(m(b,!0,z))},onBlur:function(z){return g(m(b,!0,z))},readOnly:M,suffix:w&&(0,e.jsx)("span",{className:v+"-option-suffix",children:(0,e.jsx)(A.Z,{html:w})})})]},b)})})})}(0,E.RM)("Checkbox",(0,U.Pi)($n),"antd");var Xt=x(71153),Xe=x(60331),Jt=x(62999),On=x(95222),fe=x(3980),kn=x(60780),Ln=x.n(kn);function Hn(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children,h=g===void 0?[]:g,c=h[0].id,o=(0,Z.useState)([]),v=(0,L.Z)(o,2),i=v[0],r=v[1];function u(m){c&&((m==null?void 0:m.length)===0?l(void 0):l((0,X.Z)({},c,m==null?void 0:m.map(function(f){return f.value}))))}var s=(0,Z.useMemo)(function(){return Ln()(i.map(function(m){return{title:m.name,key:m.id,value:m.id,parentId:m.parentId}}),{parentProperty:"parentId",customID:"key"})},[i]);return(0,Z.useEffect)(function(){fe.hi.selectDept({}).then(function(m){m.success&&r(m.data)})},[]),(0,e.jsx)(te.Z,{children:(0,e.jsx)(_.Z,{span:24,children:(0,e.jsx)(On.Z,{style:{width:"100%"},treeCheckable:!0,value:(a[c]||[]).map(function(m){return{value:m}}),treeCheckStrictly:!0,showCheckedStrategy:"SHOW_ALL",dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:s,placeholder:"\u8BF7\u9009\u62E9",treeDefaultExpandAll:!0,onChange:u,showSearch:!1})})})}var zn=function(n){var l=n.schema,d=n.value,a=d===void 0?{}:d,g=l.children,h=g===void 0?[]:g,c=h[0].id,o=(0,Z.useState)([]),v=(0,L.Z)(o,2),i=v[0],r=v[1];return(0,Z.useEffect)(function(){fe.hi.selectDept({selected:a[c]||[],name:"^_^"}).then(function(u){u.success&&r(u.data)})},[]),(0,e.jsx)("div",{className:"preview",children:(0,e.jsx)(Pe.Z,{children:i.map(function(u){return(0,e.jsx)(Xe.Z,{color:"blue",children:u.name},u.id)})})})};(0,E.RM)("Dept",Hn,"antd"),(0,E.cf)("Dept",zn,"antd");function Je(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=t.onBlur,h=n.children,c=(0,P.AK)("-body-question");function o(i,r){a[i]=r,r===""&&delete a[i],l((0,B.Z)({},a),i)}function v(i,r){a[i]=r,r===""&&delete a[i],g((0,B.Z)({},a),i)}return(0,e.jsx)("div",{children:h==null?void 0:h.map(function(i){var r=i.id,u=i.title;return(0,e.jsxs)(te.Z,{style:{marginBottom:10},"data-id":r,children:[u&&(0,e.jsx)(_.Z,{className:c+"-option",span:4,children:i.title&&(0,e.jsx)("span",{className:c+"-option-title",children:(0,e.jsx)(A.Z,{html:i.title})})},i.id),(0,e.jsxs)(_.Z,{span:12,className:c+"-option",children:[(0,e.jsx)(gn,{qId:n.id,schema:i,value:a,onChange:function(m){return o(r,m)},onBlur:function(m){return v(r,m)}}),(0,e.jsx)(Fe,{schema:i,type:n.type})]})]},r)})})}(0,E.RM)("FillBlank",Je,"antd"),(0,E.RM)("MultipleBlank",Je,"antd");function Un(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=t.onBlur,h=n.children,c=n.attribute,o=c===void 0?{}:c,v=o.content;return!v||!h?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)(Ze,{schema:n,children:h.filter(function(i){var r;return!((r=i.attribute)!==null&&r!==void 0&&r.fieldInTitle)}),content:v,onBlur:g,onChange:l,value:a})}var Wn=function(n){var l=n.schema,d=n.value,a=l.children,g=l.attribute,h=g===void 0?{}:g,c=h.content;return(0,e.jsx)("div",{className:"preview pe-view",children:(0,e.jsx)(A.Z,{html:We(c,a,d),replaceP:!1},Math.random())})};(0,E.RM)("HorzBlank",Un,"antd"),(0,E.cf)("HorzBlank",Wn,"antd");var Re=x(83279),me=x(79521),Vn=x(54121),Kn=function(n){var l=(0,fe.XI)(200),d=(0,L.Z)(l,2),a=d[0],g=d[1],h=(0,fe.XI)(200),c=(0,L.Z)(h,2),o=c[0],v=c[1];return(0,e.jsxs)("div",(0,B.Z)((0,B.Z)({},n.getRowProps()),{},{className:"tr",style:{position:"relative"},ref:a,children:[n.cells.map(function(i){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},i.getCellProps()),{},{className:"td","data-id":"".concat(n.i,"-").concat(i.column.id),children:i.render("Cell")}))}),n.onDelete&&(0,e.jsx)("div",{ref:o,style:{position:"absolute",left:-20,top:0,height:48,width:24,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(Vn.Z,{onClick:function(){n.onDelete()},style:{color:"#f5222d",cursor:"pointer",visibility:g||v?"visible":"hidden"}})})]}))};function qe(t){var n=t.columns,l=t.data,d=t.onAdd,a=t.onDelete,g=Z.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),h=(0,me.useTable)({columns:n,data:l,defaultColumn:g},me.useBlockLayout),c=h.getTableProps,o=h.getTableBodyProps,v=h.headerGroups,i=h.rows,r=h.prepareRow;return(0,e.jsxs)("div",(0,B.Z)((0,B.Z)({},c()),{},{className:"table",children:[(0,e.jsx)("div",{children:v.map(function(u){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},u.getHeaderGroupProps()),{},{className:"tr",children:u.headers.map(function(s){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},s.getHeaderProps()),{},{className:"th",children:s.render("Header")}))})}))})}),(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},o()),{},{children:i.map(function(u,s){return r(u),(0,Z.createElement)(Kn,(0,B.Z)((0,B.Z)({},u),{},{key:s,i:s,onDelete:a?function(){return a(s)}:void 0}))})})),d&&(0,e.jsx)("div",{className:"footer",onClick:d,children:"+ \u7EE7\u7EED\u586B\u5199"})]}))}function Yn(t){var n,l=t.schema,d=t.onChange,a=t.value||[{}],g=l.children,h=g===void 0?[]:g,c=(0,W.Ck)((n=l.attribute)===null||n===void 0?void 0:n.scope,[1,999]),o=(0,Z.useMemo)(function(){return h.map(function(v){var i;return{Header:(0,e.jsx)(A.Z,{html:v.title}),width:(i=v.attribute)===null||i===void 0?void 0:i.width,accessor:v.id,Cell:function(u){var s,m=u.value,f=u.row,C=u.data;if(((s=v.attribute)===null||s===void 0?void 0:s.dataType)==="select"){var j;return(0,e.jsx)(H.Z,{placeholder:"\u8BF7\u9009\u62E9",value:m,style:{width:"100%"},onChange:function(p){C[f.index][v.id]=p},options:((j=v.dataSource)===null||j===void 0?void 0:j.map(function(y){return{label:y.label,value:y.value}}))||[]})}else return(0,e.jsx)(ee.Z,{value:m,onChange:function(p){C[f.index][v.id]=p.target.value,d((0,Re.Z)(C))}})}}})},[]);return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(qe,{columns:o,data:a,onAdd:a.length<c[2]?function(){a.push({}),d((0,Re.Z)(a))}:void 0,onDelete:function(i){a.splice(i,1),d((0,Re.Z)(a))}})})}var Gn=function(n){var l=n.schema,d=n.value||[{},{}],a=l.children,g=a===void 0?[]:a,h=(0,Z.useMemo)(function(){return g.map(function(c){var o;return{Header:(0,e.jsx)(A.Z,{html:c.title}),width:(o=c.attribute)===null||o===void 0?void 0:o.width,accessor:c.id,Cell:function(i){var r,u=i.value,s=i.row,m=i.data;if(((r=c.attribute)===null||r===void 0?void 0:r.dataType)==="select"){var f,C,j=((f=c.dataSource)===null||f===void 0||(C=f.find(function(y){return y.value===u}))===null||C===void 0?void 0:C.label)||"";return(0,e.jsx)("span",{children:j})}else return(0,e.jsx)("span",{children:u})}}})},[]);return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(qe,{columns:h,data:d})})};(0,E.RM)("MatrixAuto",Yn,"antd"),(0,E.cf)("MatrixAuto",Gn,"antd");var ye=x(93224),Qn=["title","rowId"],Xn=["title","rowId"];function _e(t){var n=t.columns,l=t.data,d=Z.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),a=(0,me.useTable)({columns:n,data:l,defaultColumn:d},me.useBlockLayout),g=a.getTableProps,h=a.getTableBodyProps,c=a.headerGroups,o=a.rows,v=a.prepareRow;return(0,e.jsxs)("div",(0,B.Z)((0,B.Z)({},g()),{},{className:"table",children:[(0,e.jsx)("div",{children:c.map(function(i){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},i.getHeaderGroupProps()),{},{className:"tr",children:i.headers.map(function(r){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},r.getHeaderProps()),{},{className:"th",children:r.render("Header")}))})}))})}),(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},h()),{},{children:o.map(function(i){return v(i),(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},i.getRowProps()),{},{className:"tr",children:i.cells.map(function(r){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},r.getCellProps()),{},{className:"td",children:r.render("Cell")}))})}))})}))]}))}function Jn(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children,h=g===void 0?[]:g,c=n.row,o=c===void 0?[]:c,v=(0,Z.useMemo)(function(){var r,u=h.map(function(s){var m;return{Header:(0,e.jsx)(A.Z,{html:s.title}),width:(m=s.attribute)===null||m===void 0?void 0:m.width,accessor:s.id,Cell:function(C){var j,y=C.value,p=C.row,b=C.data,N=(j=s.attribute)===null||j===void 0?void 0:j.dataType;return(0,e.jsxs)("div",{onClick:function(M){var S=!y,I={};b.forEach(function(D,R){var $=D.title,k=D.rowId,O=(0,ye.Z)(D,Qn);p.index===R&&(S?O[s.id]=!0:delete O[s.id]),I[k]=O}),l(I)},style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,e.jsx)(pe.Z,{checked:!!y}),N?(0,e.jsx)(he,{type:N,style:{width:120,marginLeft:5},value:y===!0?"":y,onChange:function(M){var S={};b.forEach(function(I,D){var R=I.title,$=I.rowId,k=(0,ye.Z)(I,Xn);p.index===D&&(k[s.id]=M),S[$]=k}),l(S)},onBlur:function(){}}):(0,e.jsx)("div",{style:{height:32,width:1}})]})}}});return u.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:((r=n.attribute)===null||r===void 0?void 0:r.width)||150,accessor:"title"}),u},[]),i=o.map(function(r,u){var s=r.id,m=a[s]||{};return(0,B.Z)({title:(0,e.jsx)(A.Z,{html:r.title}),rowId:s},m)});return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(_e,{columns:v,data:i})})}var qn=function(n){var l=n.schema,d=n.value,a=d===void 0?{}:d,g=l.children,h=g===void 0?[]:g,c=l.row,o=c===void 0?[]:c,v=(0,Z.useMemo)(function(){var r,u=h.map(function(s){var m;return{Header:(0,e.jsx)(A.Z,{html:s.title}),width:(m=s.attribute)===null||m===void 0?void 0:m.width,accessor:s.id,Cell:function(C){var j=C.value,y=C.row,p=C.data;return j?(0,e.jsx)("div",{children:(0,e.jsx)(pe.Z,{checked:!!j,disabled:!0})}):(0,e.jsx)(e.Fragment,{})}}});return u.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:((r=l.attribute)===null||r===void 0?void 0:r.width)||150,accessor:"title"}),u},[]),i=o.map(function(r,u){var s=r.id,m=a[s]||{};return(0,B.Z)({title:(0,e.jsx)(A.Z,{html:r.title}),rowId:s},m)});return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(_e,{columns:v,data:i})})};(0,E.RM)("MatrixCheckbox",Jn,"antd"),(0,E.cf)("MatrixCheckbox",qn,"antd");var _n=["title","rowId"];function en(t){var n=t.columns,l=t.data,d=Z.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),a=(0,me.useTable)({columns:n,data:l,defaultColumn:d},me.useBlockLayout),g=a.getTableProps,h=a.getTableBodyProps,c=a.headerGroups,o=a.rows,v=a.prepareRow;return(0,e.jsxs)("div",(0,B.Z)((0,B.Z)({},g()),{},{className:"table",children:[(0,e.jsx)("div",{children:c.map(function(i){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},i.getHeaderGroupProps()),{},{className:"tr",children:i.headers.map(function(r){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},r.getHeaderProps()),{},{className:"th",children:r.render("Header")}))})}))})}),(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},h()),{},{children:o.map(function(i){return v(i),(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},i.getRowProps()),{},{className:"tr",children:i.cells.map(function(r){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},r.getCellProps()),{},{className:"td","data-id":"".concat(i.original.rowId,"-").concat(r.column.id),children:r.render("Cell")}))})}))})}))]}))}function et(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children,h=g===void 0?[]:g,c=n.row,o=c===void 0?[]:c,v=(0,Z.useMemo)(function(){var r,u=h.map(function(s){var m;return{Header:(0,e.jsx)(A.Z,{html:s.title}),width:(m=s.attribute)===null||m===void 0?void 0:m.width,accessor:s.id,Cell:function(C){var j=C.value,y=C.row,p=C.data;return(0,e.jsx)(he,{value:j,onChange:function(N){var w={};p.forEach(function(M,S){var I=M.title,D=M.rowId,R=(0,ye.Z)(M,_n);y.index===S&&(R[s.id]=N),w[D]=R}),l(w)}})}}});return u.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:((r=n.attribute)===null||r===void 0?void 0:r.width)||150,accessor:"title"}),u},[]),i=o.map(function(r,u){var s=r.id,m=a[s]||{};return(0,B.Z)({title:(0,e.jsx)(A.Z,{html:r.title}),rowId:s},m)});return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(en,{columns:v,data:i})})}var nt=function(n){var l=n.schema,d=n.value,a=d===void 0?{}:d,g=l.children,h=g===void 0?[]:g,c=l.row,o=c===void 0?[]:c,v=(0,Z.useMemo)(function(){var r,u=h.map(function(s){var m;return{Header:function(){return(0,e.jsx)(A.Z,{html:s.title})},width:(m=s.attribute)===null||m===void 0?void 0:m.width,accessor:s.id,Cell:function(C){var j=C.value;return(0,e.jsx)("span",{children:j})}}});return u.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:(r=l.attribute)===null||r===void 0?void 0:r.width,accessor:"title"}),u},[]),i=o.map(function(r,u){var s=r.id,m=a[s]||{};return(0,B.Z)({title:r.title,rowId:s},m)});return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(en,{columns:v,data:i})})};(0,E.RM)("MatrixFillBlank",et,"antd"),(0,E.cf)("MatrixFillBlank",nt,"antd");var tt=["title","rowId"],at=["title","rowId"];function nn(t){var n=t.columns,l=t.data,d=Z.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),a=(0,me.useTable)({columns:n,data:l,defaultColumn:d},me.useBlockLayout),g=a.getTableProps,h=a.getTableBodyProps,c=a.headerGroups,o=a.rows,v=a.prepareRow;return(0,e.jsxs)("div",(0,B.Z)((0,B.Z)({},g()),{},{className:"table",children:[(0,e.jsx)("div",{children:c.map(function(i){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},i.getHeaderGroupProps()),{},{className:"tr",children:i.headers.map(function(r){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},r.getHeaderProps()),{},{className:"th",children:r.render("Header")}))})}))})}),(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},h()),{},{children:o.map(function(i){return v(i),(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},i.getRowProps()),{},{className:"tr",children:i.cells.map(function(r){return(0,e.jsx)("div",(0,B.Z)((0,B.Z)({},r.getCellProps()),{},{className:"td",children:r.render("Cell")}))})}))})}))]}))}function rt(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children,h=g===void 0?[]:g,c=n.row,o=c===void 0?[]:c,v=(0,Z.useMemo)(function(){var u;return((u=n.children)===null||u===void 0?void 0:u.filter(function(s){var m;return(m=s.attribute)===null||m===void 0?void 0:m.exclusiveFillBlankInMatrix}).map(function(s){return s.id}))||[]},[n]),i=(0,Z.useMemo)(function(){var u,s,m=h.map(function(f){var C;return{Header:(0,e.jsx)(A.Z,{html:f.title}),width:(C=f.attribute)===null||C===void 0?void 0:C.width,accessor:f.id,Cell:function(y){var p,b,N=y.value,w=y.row,M=y.data,S=(p=f.attribute)===null||p===void 0?void 0:p.exclusiveFillBlankInMatrix,I=(b=f.attribute)===null||b===void 0?void 0:b.dataType;return(0,e.jsxs)("div",{onClick:function(){if(!S){var R={};M.forEach(function($,k){var O=$.title,K=$.rowId,z=(0,ye.Z)($,tt);w.index===k?(R[K]={},v.forEach(function(G){R[K][G]=z[G]}),R[K][f.id]=!0):R[K]=z}),l(R)}},style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[!S&&(0,e.jsx)(be.ZP,{checked:!!N}),I?(0,e.jsx)(he,{type:I,style:{width:120},value:N===!0?"":N,onChange:function(R){var $={};M.forEach(function(k,O){var K=k.title,z=k.rowId,G=(0,ye.Z)(k,at);w.index===O?(S?$[z]=G:($[z]={},v.forEach(function(q){$[z][q]=G[q]})),$[z][f.id]=R):$[z]=G}),l($)},onBlur:function(){}}):(0,e.jsx)("div",{style:{height:32,width:1}})]})}}});return m.splice(0,0,{Header:(0,e.jsx)(A.Z,{html:(u=n.attribute)===null||u===void 0?void 0:u.cornerText}),width:((s=n.attribute)===null||s===void 0?void 0:s.width)||150,accessor:"title"}),m},[]),r=o.map(function(u,s){var m=u.id,f=a[m]||{};return(0,B.Z)({title:(0,e.jsx)(A.Z,{html:u.title}),rowId:m},f)});return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(nn,{columns:i,data:r})})}var it=function(n){var l=n.schema,d=n.value,a=d===void 0?{}:d,g=l.children,h=g===void 0?[]:g,c=l.row,o=c===void 0?[]:c,v=(0,Z.useMemo)(function(){var r,u,s=h.map(function(m){var f;return{Header:(0,e.jsx)(A.Z,{html:m.title}),width:(f=m.attribute)===null||f===void 0?void 0:f.width,accessor:m.id,Cell:function(j){var y=j.value,p=j.row,b=j.data;return y?(0,e.jsx)("div",{children:(0,e.jsx)(be.ZP,{checked:!!y,disabled:!0})}):(0,e.jsx)(e.Fragment,{})}}});return s.splice(0,0,{Header:(0,e.jsx)(A.Z,{html:(r=l.attribute)===null||r===void 0?void 0:r.cornerText}),width:((u=l.attribute)===null||u===void 0?void 0:u.width)||150,accessor:"title"}),s},[]),i=o.map(function(r,u){var s=r.id,m=a[s]||{};return(0,B.Z)({title:(0,e.jsx)(A.Z,{html:r.title}),rowId:s},m)});return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(nn,{columns:v,data:i})})};(0,E.RM)("MatrixRadio",rt,"antd"),(0,E.cf)("MatrixRadio",it,"antd");function lt(t){for(var n=[],l=2;l<t+2;l++)n.push(l/(t+2));return n}function st(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,d=[],a=t;a<=n;a++)d.push(a);return l&&d.reverse(),d}function dt(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children,h=g===void 0?[]:g,c=h[0].id,o=(0,Z.useState)(function(){return a[c]||-1}),v=(0,L.Z)(o,2),i=v[0],r=v[1];function u(m){l((0,X.Z)({},c,m))}(0,Z.useEffect)(function(){Object.keys(a).length>0&&r(a[c])},[a,c]);var s=function(f){var C=a[f.id],j=f.attribute||{},y=j.scope,p=y===void 0?"[0,10]":y,b=j.npsInvertSort,N=j.npsStart,w=N===void 0?"\u4E0D\u53EF\u80FD":N,M=j.npsEnd,S=M===void 0?"\u6781\u6709\u53EF\u80FD":M,I=p.replace("[","").replace("]","").split(","),D=(0,L.Z)(I,2),R=D[0],$=D[1],k=lt(i||0);return(0,e.jsxs)("div",{className:"nps",onMouseLeave:function(){r(C)},children:[(0,e.jsx)("div",{className:"nps-container",children:st(parseInt(R),parseInt($),b).map(function(O){var K={background:"#2672ff",opacity:k[O]};return(0,e.jsx)("div",{className:"nps-item",style:i>=O?K:void 0,onMouseOver:function(){r(O)},onClick:function(){return u(O)},children:O},O)})}),(0,e.jsxs)("div",{className:"nps-tip",children:[(0,e.jsx)("div",{children:b?S:w}),(0,e.jsx)("div",{children:b?w:S})]})]},f.id)};return(0,e.jsx)(te.Z,{children:h.map(function(m){return s(m)})})}(0,E.RM)("Nps",dt,"antd");var ot=be.ZP.Group;function ut(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=t.onBlur,h=n.children,c=n.attribute,o=24/((c==null?void 0:c.columns)||1),v=(0,P.AK)("-body-question"),i=!!(c!=null&&c.statEnabled),r=(0,P.Rk)(),u=r.hiddenOption[n.id]||[],s=(0,P.Al)();function m(j){var y,p=j.target.value,b=(y=n.children)===null||y===void 0?void 0:y.find(function(w){return w.id===p});if(b){var N=b.id;l((0,X.Z)({},j.target.value,a[N]||!0))}}(0,Z.useEffect)(function(){var j=Object.keys(a)[0];u.includes(j)&&l(void 0)},[u]);function f(j,y){l((0,X.Z)({},j,y||!0),j)}function C(j,y){g((0,X.Z)({},j,y||!0),j)}return(0,Z.useEffect)(function(){var j;(j=n.children)===null||j===void 0||j.forEach(function(y){var p,b=y.id,N=y.attribute,w=N==null?void 0:N.dataType;(p=y.attribute)!==null&&p!==void 0&&p.defaultChecked&&Object.keys(a).length===0&&l((0,X.Z)({},b,w?a[b]:!0))})},[]),(0,e.jsx)("div",{children:(0,e.jsx)(ot,{onChange:m,value:Object.keys(a)[0],style:{width:"100%"},children:(0,e.jsx)(te.Z,{children:h==null?void 0:h.filter(function(j){return!u.includes(j.id)}).map(function(j){var y,p,b,N,w=j.id,M=(y=j.attribute)===null||y===void 0?void 0:y.dataType,S=(p=j.attribute)===null||p===void 0?void 0:p.suffix,I=(b=j.attribute)===null||b===void 0?void 0:b.readOnly,D=(N=j.attribute)===null||N===void 0?void 0:N.quota,R=!1;if(D!==void 0){var $,k=s.statistics,O=k==null?void 0:k.questionStatistics[n.id],K=(O==null||($=O.optionStatistics.find(function(G){return G.optionId===w}))===null||$===void 0?void 0:$.count)||0,z=D-K;z<=0&&(R=!0)}return(0,e.jsxs)(_.Z,{span:o,className:v+"-option","data-id":w,children:[(0,e.jsx)(xn,{qId:n.id,schema:j,disabled:R,value:a[w],onChange:function(q){return f(w,q)},onBlur:function(q){return C(w,q)}}),(0,e.jsx)(ze,{statEnabled:i,quota:D,checked:!!a[w],optionId:w,questionId:n.id,checkedCount:Object.keys(a).length}),M&&(0,e.jsx)(he,{value:a[w]===!0?"":a[w],type:M,schema:j,readOnly:I,style:{maxWidth:200},onChange:function(q){return f(w,q)},onBlur:function(q){return C(w,q)},suffix:S&&(0,e.jsx)("span",{className:v+"-option-suffix",children:(0,e.jsx)(A.Z,{html:S})})})]},w)})})})})}(0,E.RM)("Radio",(0,U.Pi)(ut),"antd");function ct(t){var n=(0,P.AK)("-body-question");return(0,e.jsx)("div",{className:n,children:(0,e.jsx)(A.Z,{html:"".concat(t.replaceTitle||t.schema.title||"")})})}var vt=function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(A.Z,{html:"".concat(n.replaceTitle||n.schema.title||"")})})};(0,E.RM)("Remark",ct,"antd"),(0,E.cf)("Remark",vt,"antd");var qt=x(96433),Te=x(2864),tn=x(41687),ht=x(46870),an=x(18613),ft=x(57206),mt={1:(0,e.jsx)(tn.Z,{}),2:(0,e.jsx)(tn.Z,{}),3:(0,e.jsx)(ht.Z,{}),4:(0,e.jsx)(an.Z,{}),5:(0,e.jsx)(an.Z,{})};function xt(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children,h=g===void 0?[]:g;function c(v,i){l((0,X.Z)({},v,i))}var o=function(i){var r=i.attribute||{},u=i.id,s=r.scope,m=s===void 0?"[0,5]":s,f=r.scoreStyle,C=m.replace("[","").replace("]","").split(","),j=(0,L.Z)(C,2),y=j[0],p=j[1];return f==="heart"?(0,e.jsx)(Te.Z,{defaultValue:parseInt(y),character:(0,e.jsx)(ft.Z,{}),style:{color:"#ea7463"},value:a[u],count:parseInt(p),onChange:function(N){return c(u,N)}},u):f==="smile"?(0,e.jsx)(Te.Z,{defaultValue:parseInt(y),character:function(N){var w=N.index;return mt[w+1]},count:parseInt(p),onChange:function(N){return c(u,N)},value:a[u]},u):(0,e.jsx)(Te.Z,{defaultValue:parseInt(y),count:parseInt(p),value:a[u],onChange:function(N){return c(u,N)}},u)};return(0,e.jsx)(te.Z,{children:h.map(function(v){return o(v)})})}(0,E.RM)("Score",xt,"antd");function gt(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children,h=g===void 0?[]:g;function c(o){var v,i=(v=n.children)===null||v===void 0?void 0:v.find(function(r){return r.id===o});i&&l((0,X.Z)({},o,!0))}return(0,Z.useEffect)(function(){var o;(o=n.children)===null||o===void 0||o.forEach(function(v){var i,r=v.id;(i=v.attribute)!==null&&i!==void 0&&i.defaultChecked&&Object.keys(a).length===0&&l((0,X.Z)({},r,!0))})},[]),(0,e.jsx)(te.Z,{children:(0,e.jsx)(_.Z,{span:12,children:(0,e.jsx)(H.Z,{placeholder:"\u8BF7\u9009\u62E9",allowClear:!0,onClear:function(){l(void 0)},showSearch:!0,value:Object.keys(a)[0],filterOption:function(v,i){return(i==null?void 0:i.label).toLowerCase().indexOf(v.toLowerCase())!==-1},onChange:c,style:{width:260},options:h.map(function(o){return{label:o.title,value:o.id}})})})})}(0,E.RM)("Select",gt,"antd");var _t=x(34669),jt=x(82833);function Ct(t){var n=t.schema,l=t.onChange,d=n.children,a=(0,P.Al)(),g=(0,Z.useState)(0),h=(0,L.Z)(g,2),c=h[0],o=h[1];function v(i,r){var u="signature-".concat(r,"-").concat((0,W.kb)(6),".png");if(!a.onUpload){l((0,X.Z)({},r,[u]));return}fetch(i).then(function(s){return s.blob()}).then(function(s){var m=new File([s],u,{type:"image/png"});a.onUpload({file:m},function(f){o(f.loaded/f.total*100)}).then(function(f){f.success&&f.data.id&&l((0,X.Z)({},r,[f.data.id]))})})}return(0,e.jsx)("div",{children:d==null?void 0:d.map(function(i){var r=i.id,u=i.title;return(0,e.jsxs)(te.Z,{gutter:[10,0],"data-id":r,children:[u&&(0,e.jsx)(_.Z,{span:24},i.id),(0,e.jsxs)(_.Z,{span:24,children:[(0,e.jsx)(ln,{onChange:function(m){return v(m,r)}}),c>0&&c!==100&&(0,e.jsx)(jt.Z,{percent:c,size:"small",showInfo:!1})]})]},r)})})}var yt=function(n){var l=n.value,d;return l&&(d=Object.values(l)[0][0]),(0,e.jsx)("div",{className:"preview signature-print",children:d&&(0,e.jsx)("img",{src:"/api/file?id=".concat(d)})})};(0,E.RM)("Signature",Ct,"antd"),(0,E.cf)("Signature",yt,"antd");var De=x(27049);function pt(t){var n=(0,P.AK)("-body-question");return(0,e.jsx)("div",{className:n,children:(0,e.jsx)(De.Z,{plain:!0})})}var Zt=function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(De.Z,{plain:!0})})};(0,E.RM)("SplitLine",pt,"antd"),(0,E.cf)("SplitLine",Zt,"antd");function bt(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children,h=(0,P.AK)("-body-question");function c(o,v){a[o]=v,v===""&&delete a[o],l((0,B.Z)({},a))}return(0,e.jsx)("div",{children:g==null?void 0:g.map(function(o){var v=o.id,i=o.attribute,r=o.title,u=(0,W.Ck)(i==null?void 0:i.autoSize,[2,4]);return(0,e.jsxs)(te.Z,{style:{marginBottom:10},"data-id":v,children:[r&&(0,e.jsx)(_.Z,{className:h+"-option",span:4,children:o.title&&(0,e.jsx)("span",{className:h+"-option-title",children:o.title})},o.id),(0,e.jsx)(_.Z,{span:12,children:(0,e.jsx)(ee.Z.TextArea,{autoSize:{minRows:u[1],maxRows:u[2]},value:a[v]||"",onChange:function(m){return c(v,m.target.value)}})})]},v)})})}(0,E.RM)("Textarea",bt,"antd");var wt=x(43347),Bt=Be.Z.Dragger;function St(t){var n=t.schema,l=t.onChange,d=t.value,a=t.readOnly,g=n.children,h=(0,P.Al)(),c=(0,Z.useState)(),o=(0,L.Z)(c,2),v=o[0],i=o[1];(0,Z.useEffect)(function(){var s=n.children[0].id,m=d&&d[s]||[];v==null&&m.length>0&&fe.hi.loadFiles({ids:m}).then(function(f){i(f==null?void 0:f.map(function(C){return{name:C.originalName,uid:C.id,status:"done"}}))})},[d]);var r=function(){var s=(0,Qe.Z)((0,Se.Z)().mark(function m(f){var C,j,y,p;return(0,Se.Z)().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:C=f.onSuccess,j=f.onError,y=f.file,p=f.onProgress,h.onUpload&&h.onUpload({file:y},function(w){p&&p({percent:w.loaded/w.total*100})}).then(function(w){if(w.success&&C&&C(w.data),!w.success&&j){var M=new Error("Some error");j({event:M})}});case 2:case"end":return N.stop()}},m)}));return function(f){return s.apply(this,arguments)}}(),u=function(m,f){if(i(m.fileList),(m.file.status==="removed"||m.file.status==="done")&&!m.fileList.find(function(j){return j.status!=="done"})){var C=m.fileList.filter(function(j){return j.status==="done"}).map(function(j){var y;return((y=j.response)===null||y===void 0?void 0:y.id)||j.uid});C.length===0?l(void 0):l((0,X.Z)({},f,C))}};return(0,e.jsx)("div",{children:g==null?void 0:g.map(function(s){var m=s.id,f=s.attribute,C=[];if(f){var j=f.maxFileCount,y=f.maxFileSize,p=f.fileAccept;j&&C.push("\u6700\u591A\u4E0A\u4F20".concat(j,"\u4E2A")),y&&C.push("\u9650\u5236\u6BCF\u4E2A\u6587\u4EF6".concat(y,"M\u4EE5\u5185")),p&&C.push("\u4EC5\u652F\u6301\u6587\u4EF6\u7C7B\u578B\uFF1A".concat(p))}return(0,e.jsxs)(Bt,{multiple:!0,disabled:a,maxCount:(f==null?void 0:f.maxFileCount)||20,accept:f==null?void 0:f.fileAccept,beforeUpload:function(N){return f!=null&&f.maxFileSize&&N.size>f.maxFileSize*1024*1024?(Ge.default.error("\u6700\u5927\u53EA\u80FD\u4E0A\u4F20 ".concat(f.maxFileSize,"M \u5927\u5C0F\u7684\u6587\u4EF6")),Be.Z.LIST_IGNORE):!0},customRequest:r,onChange:function(N){return u(N,m)},fileList:v,children:[(0,e.jsx)("p",{className:"ant-upload-drag-icon",children:(0,e.jsx)(wt.Z,{})}),(0,e.jsx)("p",{className:"ant-upload-text",children:"\u9009\u62E9\u6216\u62D6\u62FD\u4E0A\u4F20\u6587\u4EF6"}),(0,e.jsx)("p",{className:"ant-upload-hint",children:C.join(",")})]},m)})})}(0,E.RM)("Upload",St,"antd");var Nt=x(55686),Et=H.Z.Option;function At(t){var n=t.schema,l=t.onChange,d=t.value,a=d===void 0?{}:d,g=n.children,h=g===void 0?[]:g,c=h[0].id,o=(0,Z.useState)([]),v=(0,L.Z)(o,2),i=v[0],r=v[1];function u(f){c&&l((0,X.Z)({},c,f))}var s=(0,fe.zE)(function(f){fe.hi.selectUser({name:f,selected:a[c]||[]}).then(function(C){C.success&&r(C.data)})},5),m=function(C){u(C?i.map(function(j){return j.userId}):void 0)};return(0,Z.useEffect)(function(){var f;s(""),(f=n.children)===null||f===void 0||f.forEach(function(C){var j,y=C.id;(j=C.attribute)!==null&&j!==void 0&&j.defaultChecked&&Object.keys(a).length===0&&l((0,X.Z)({},y,!0))})},[]),(0,e.jsx)(te.Z,{children:(0,e.jsx)(_.Z,{span:24,children:(0,e.jsx)(H.Z,{placeholder:"\u8BF7\u9009\u62E9",allowClear:!0,filterOption:!1,mode:"multiple",onClear:function(){l(void 0)},style:{width:"100%"},value:a[c]||[],onSearch:s,showSearch:!0,onChange:u,dropdownRender:function(C){return(0,e.jsxs)("div",{children:[C,(0,e.jsx)(De.Z,{style:{margin:"4px 0"}}),(0,e.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",paddingLeft:10},children:(0,e.jsx)(pe.Z,{onChange:function(y){m(y.target.checked)},children:"\u5168\u9009"})})]})},children:i.map(function(f){return(0,e.jsx)(Et,{value:f.userId,label:f.name,children:(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{role:"img",style:{marginRight:10},children:(0,e.jsx)(Nt.Z,{user:f,size:20})}),f.name," ",f.deptName&&"(".concat(f.deptName,")")]})},f.userId)})})})})}var Mt=function(n){var l=n.schema,d=n.value,a=d===void 0?{}:d,g=l.children,h=g===void 0?[]:g,c=h[0].id,o=(0,Z.useState)([]),v=(0,L.Z)(o,2),i=v[0],r=v[1];return(0,Z.useEffect)(function(){fe.hi.selectUser({selected:a[c]||[],name:"^_^"}).then(function(u){u.success&&r(u.data)})},[]),(0,e.jsx)("div",{className:"preview",children:(0,e.jsx)(Pe.Z,{children:i.map(function(u){return(0,e.jsx)(Xe.Z,{color:"blue",children:u.name},u.userId)})})})};(0,E.RM)("User",At,"antd"),(0,E.cf)("User",Mt,"antd");var Pt=x(73328),Ft=function(n){var l=(0,Z.useRef)(null),d=(0,Z.useState)(!1),a=(0,L.Z)(d,2),g=a[0],h=a[1];return(0,Pt.Z)(l,function(){h(!1)}),(0,e.jsx)("div",{className:ge()("preview",{active:g}),ref:l,onClick:function(){h(!0)},children:(0,e.jsx)(A.Z,{html:Object.values(n.value||{})[0]})})};(0,W.cf)("RichText",Ft,"antd");var It=function(n){return(0,e.jsx)(e.Fragment,{children:n.children})},Rt=It;(0,W.RM)("RichText",(0,Z.lazy)(function(){return Promise.all([x.e(9548),x.e(4177),x.e(6779),x.e(3710),x.e(2684),x.e(6625),x.e(596),x.e(811),x.e(7462)]).then(x.bind(x,27321))}),"antd"),(0,W.cf)("Upload",(0,Z.lazy)(function(){return Promise.all([x.e(9548),x.e(6779),x.e(6661),x.e(4502),x.e(9452)]).then(x.bind(x,43640))}),"antd")},55686:function(je,ae,x){"use strict";var L=x(11849),W=x(94233),A=x(51890),U=x(93224),Z=x(89366),P=x(85893),E=["user"],re=function(le){var se=le.user,ie=(0,U.Z)(le,E);return!se||!se.avatar?(0,P.jsx)(A.C,(0,L.Z)({icon:(0,P.jsx)(Z.Z,{}),size:ie.size||"small"},ie)):(0,P.jsx)(A.C,(0,L.Z)({src:"/api/public/preview/".concat(se.avatar),size:ie.size||"small"},ie))};ae.Z=re},78210:function(je,ae,x){"use strict";var L=x(27856),W=x.n(L),A=x(15020),U=x(85893),Z=function(E){var re=E.html,e=re===void 0?"":re,le=E.replaceP,se=le===void 0?!0:le;return se?(0,U.jsx)("div",{className:"pe-view",children:typeof e=="string"&&(0,A.ZP)(W().sanitize(e,{ADD_TAGS:["iframe"],ADD_ATTR:["allow","allowfullscreen","frameborder","scrolling"]}).replace(/<p>/,"<span>").replace(/<\/p>/,"</span>"))}):(0,U.jsx)(U.Fragment,{children:typeof e=="string"&&(0,A.ZP)(W().sanitize(e))})};ae.Z=Z},49914:function(je,ae,x){"use strict";x.d(ae,{H:function(){return A}});var L=x(67294),W=x(96389);function A(){return(0,L.useContext)(W.ff)}},39002:function(je,ae,x){"use strict";var L=x(38663),W=x.n(L),A=x(92801),U=x.n(A),Z=x(14965)}}]);
